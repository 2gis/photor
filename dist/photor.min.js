!function(a){function b(a,c){var d=this instanceof b?this:g(b.prototype);return d._init(a,c),d}function c(a){"undefined"!=typeof console&&(console.error?console.error(a):console.log("Error: "+a))}function d(a){return a._uid||(a._uid=++B)}function f(a){var b=Array.prototype.slice.call(arguments,1);return a.replace(/%(\d+)/g,function(a,c){return b[Number(c)-1]})}function g(a){var b=D(a);if(arguments.length>1)for(var c=1,d=arguments.length;d>c;c++){var e=arguments[c];e===Object(e)&&h(b,e)}return b}function h(a,b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c]);return a}function i(a){var b=document.createElement("div");return b.innerHTML=a,1==b.childNodes.length&&1==b.firstChild.nodeType?b.firstChild:b}function j(a,b,c){if(c)for(;a=a.parentNode;){if(a==b)return!0;if(a==c)break}else for(;a=a.parentNode;)if(a==b)return!0;return!1}function k(a,b,c){return a==b||j(a,b,c)}function l(a){for(;a.lastChild;)a.removeChild(a.lastChild);return a}function m(a,b,c){var d=new Image;d.onload=d.onerror=function(a){d.onload=d.onerror=null,b.call(c,"load"==a.type,d)},d.src=a}function n(){this.returnValue=!1}function o(){this.cancelBubble=!0}function p(b){if(b.fixed)return b;var c=g(b);if(c.origEvent=b,b.target||(c.target=b.srcElement||document),b.pageX===a&&b.clientX!==a){var d=document.documentElement,f=document.body;c.pageX=b.clientX+(d.scrollLeft||f&&f.scrollLeft||0)-d.clientLeft,c.pageY=b.clientY+(d.scrollTop||f&&f.scrollTop||0)-d.clientTop}return b.which===a&&b.button!==a&&(1&b.button?c.which=1:4&e.button?c.which=2:2&e.button&&(c.which=3)),b.preventDefault||(c.preventDefault=n),b.stopPropagation||(c.stopPropagation=o),c.fixed=!0,c}if("undefined"!=typeof window){var q=document.createElement("div"),r=q.style,s={};!function(){for(var a=["transform","transition","transitionDuration","perspective"],b=["webkit","Moz","ms","O"],c=b.length,d=0,e=a.length;e>d;d++){var f=a[d];if(f in r)s[f]=f;else{s[f]=!1;for(var g=f.charAt(0).toUpperCase()+f.slice(1),h=0;c>h;h++){var i=b[d]+g;if(i in r){s[f]=i;break}}}}}();var t=s.transform,u=(s.transition,s.transitionDuration),v=!!s.perspective,w=(t&&{transform:"transform",webkitTransform:"-webkit-transform",MozTransform:"-moz-transform",msTransform:"-ms-transform",OTransform:"-o-transform"}[t],function(a){return-1!=a.indexOf("msie")?parseInt(a.split("msie")[1]):!1}(navigator.userAgent.toLowerCase())),x="photor__";b.prototype={constructor:b,_events:null,_params:null,_items:null,current:a,frozen:!1,_touch:null,_drag:null,_bControlWidth:a,_bControlHeight:a,_bViewportWidth:a,_bViewportHeight:a,_bThumbsWidth:a,_bThumbsHeight:a,_bThumbsLayerWidth:a,_thumbsDraggable:a,_thumbsOffset:a,element:null,bControl:null,btnPrev:null,btnNext:null,bThumbs:null,bViewport:null,bViewportLayer:null,bThumbsLayer:null,bThumbFrame:null,_slides:null,_thumbs:null,_init:function(a,b){if(a._photor)throw new TypeError("Photor is already initialized for this element");a._photor=this,this._events={};var c=this._params=h({viewport:x+"viewport",layer:x+"viewportLayer",slide:x+"viewportLayerSlide",slideImg:x+"viewportLayerSlideImg",control:x+"viewportControl",next:x+"viewportControlNext",prev:x+"viewportControlPrev",thumbs:x+"thumbs",thumbsLayer:x+"thumbsLayer",thumb:x+"thumbsLayerItem",thumbImg:x+"thumbsLayerItemImg",thumbFrame:x+"thumbsLayerFrame",_single:"_single",_dragging:"_dragging",_animated:"_animated",_freeze:"_freeze",_disabled:"_disabled",_current:"_current",_loading:"_loading",_error:"_error",_html:"_html",_caption:"_caption",_hidden:"_hidden",_auto:"_auto",_center:"_center",_portrait:"_portrait",_landscape:"_landscape",_draggable:"_draggable",modifierPrefix:"_",itemPrefix:"_item",ieClassPrefix:"_ie",current:0,autoplay:!1,loop:!1,duration:300,showThumbs:"thumbs",keyboard:!0},b);this.element=a,w&&z(a,c.ieClassPrefix+w),this.bControl=a.querySelector("."+c.control),this.btnPrev=a.querySelector("."+c.prev),this.btnNext=a.querySelector("."+c.next),this.bThumbs=a.querySelector("."+c.thumbs),this.bViewport=a.querySelector("."+c.viewport),this.bViewportLayer=a.querySelector("."+c.layer),this.bThumbsLayer=a.querySelector("."+c.thumbsLayer),this.bThumbFrame=document.createElement("div"),z(this.bThumbFrame,c.thumbFrame),this._updateDims();var d=c.data;this._setItems(d&&d.length?d:this.bViewportLayer),this._bindListeners(),this._bindEvents()},_updateDims:function(){this._bControlWidth=this.bControl.offsetWidth,this._bControlHeight=this.bControl.offsetHeight,this._bViewportWidth=window.getComputedStyle?parseFloat(window.getComputedStyle(this.bViewport).width,10):this.bViewport.offsetWidth,this._bViewportHeight=this.bViewport.offsetHeight,this._bThumbsWidth=this.bThumbs.offsetWidth,this._bThumbsHeight=this.bThumbs.offsetHeight},_setItems:function(a){var b=this._params,c=this.element;this._cancelCurrentItems(),this._renewItems(a);var d=this._items.length;this.current=b.current<d?Math.max(0,b.current):0,1==d?z(c,b._single):A(c,b._single),b.showThumbs?z(c,b.modifierPrefix+b.showThumbs):A(c,b.modifierPrefix+b.showThumbs),this._updateDOM(),this._loadActualSlides(function(){"thumbs"==b.showThumbs?this._loadThumbs(function(){this._updateThumbsDims(),this._moveToCurrent(!0)}):this._moveToCurrent(!0)})},_cancelCurrentItems:function(){var b=this.current;if(b!==a){var c=this._params._current;A(this._slides[b],c),A(this._thumbs[b],c)}},_renewItems:function(b){var c,d=this._params,e=this._items=[],f={url:a,thumb:a,html:a,element:null,caption:"",width:a,height:a,thumbDims:null,loaded:a,classes:""},h=0;if(E(b))for(c=b.length;c>h;h++){var j=g(f,{loaded:!1},b[h]);j.html&&!j.element&&(j.element=i(j.html)),e.push(j)}else{var k=!1,l=b.childNodes;for(c=l.length;c>h;h++){var m=l[h];1==m.nodeType&&("IMG"==m.nodeName?e.push(g(f,{url:m.src,thumb:m.getAttribute("data-thumb"),caption:m.alt,loaded:!1,classes:m.className})):(k=!0,e.push(g(f,{element:m,loaded:!0}))))}k&&"thumbs"==d.showThumbs&&(d.showThumbs="dots")}if(!e.length)throw new RangeError("Requires more items")},_updateDOM:function(){var a=this._params,b=this._items,c=this.bViewportLayer,d=this.bThumbsLayer,e=this._slides=[],g=this._thumbs=[];l(c),l(d);for(var h=document.createDocumentFragment(),j=document.createDocumentFragment(),k=0,m=b.length;m>k;k++){var n=b[k],o=n.element,p=f('<div data-index="%1" class="%2 %3 %4">',k,a.slide,a.itemPrefix+k,n.html?a._html:a._loading);o||(p+=a.ie&&a.ie<9?f('<img src="" class="%1 %2" />',a.slideImg,n.classes):f('<div class="%1 %2"></div>',a.slideImg,n.classes)),p+="</div>";var q=i(p);o&&q.appendChild(o),q.style.left=100*k+"%",e.push(q),h.appendChild(q);var r=f('<span data-rel="%1" class="%2 %3 %4">',k,a.thumb,a.itemPrefix+k,n.classes);"thumbs"==a.showThumbs&&n.thumb&&(r+=f('<img src="%1" data-rel="%2" class="%3" />',n.thumb,k,a.thumbImg)),r+="</span>";var s=i(r);g.push(s),j.appendChild(s)}c.appendChild(h),d.appendChild(j),"thumbs"==a.showThumbs&&d.appendChild(this.bThumbFrame)},_loadActualSlides:function(a){for(var b=this._items,d=Math.max(0,this.current-1),e=Math.min(b.length-1,this.current+1),f=0,g=d;e>=g;g++){var h=b[g];h.loaded||function(b,d,e){f++,m(e,function(g,h){if(f--,g){var i=this._params,j=this._slides[b],k=j.firstChild;d.width=h.width,d.height=h.height,d.loaded=!0,A(j,i._loading),this._alignSlideImg(b),this._orientSlideImg(b),i.ie&&i.ie<9?k.src=e:k.style.backgroundImage="url('"+e+"')"}else c("Image wasn't loaded: "+e);!f&&a&&a.call(this)},this)}.call(this,g,h,h.url)}},_loadThumbs:function(a){for(var b=this._items,d=0,e=0,f=b.length;f>e;e++){var g=b[e],h=g.thumb||g.url;h&&(d++,m(h,function(b){d--,b||c("Image wasn't loaded: "+h),!d&&a&&a.call(this)},this))}},_alignSlideImg:function(a){var b=this._params,c=this._items[a],d=this._slides[a];this._bViewportWidth>c.width&&this._bViewportHeight>c.height?(c.algorithm="center",A(d,b._auto),z(d,b._center)):(c.algorithm="auto",A(d,b._center),z(d,b._auto))},_orientSlideImg:function(a){var b=this._params,c=this._items[a],d=this._slides[a],e=this._bViewportWidth/this._bViewportHeight,f=c.width/c.height;f>=e?(c.orientation="landscape",A(d,b._portrait),z(d,b._landscape)):(c.orientation="portrait",A(d,b._landscape),z(d,b._portrait))},_updateThumbsDims:function(){if("thumbs"==this._params.showThumbs){this._bThumbsLayerWidth=this.bThumbsLayer.offsetWidth;for(var a=this._items,b=this._thumbs,c=b.length;c;){var d=b[--c];a[c].thumbDims={top:d.offsetTop,left:d.offsetLeft,width:d.offsetWidth,height:d.offsetHeight}}this._thumbsDraggable=this._bThumbsWidth<this._bThumbsLayerWidth}},_moveToCurrent:function(a){this._moveToCurrentSlide(a),this._moveToCurrentThumb(a)},_moveToCurrentSlide:function(a){var b=this._params,c=this.current,d=this.bViewportLayer;u&&(d.style[u]=a?"0ms":b.duration+"ms"),H(d,-(this._bViewportWidth*c)),z(this._slides[c],b._current)},_moveToCurrentThumb:function(a){var b=this._params;if("thumbs"==b.showThumbs){this._computeThumbsOffset();var c=this.current,d=this.bThumbsLayer,e=d.style,f=this.bThumbFrame,g=f.style,h=this._items[c].thumbDims;if(u){var i=a?"0ms":b.duration+"ms";e[u]=i,g[u]=i}H(d,this._thumbsOffset),I(f,h.left,h.top),g.width=h.width+"px",g.height=h.height+"px",z(this._thumbs[c],b._current)}},_computeThumbsOffset:function(){var a,b=this._items[this.current].thumbDims;if(this._thumbsDraggable)if(a=(this._bThumbsWidth-b.width)/2-b.left,a>0)a=0;else{var c=this._bThumbsWidth-this._bThumbsLayerWidth;c>a&&(a=c)}else a=0;this._thumbsOffset=a},_bindListeners:function(){F(this,["_onBControlTouchStart","_onBControlMouseDown","_onBThumbsTouchStart","_onBThumbsMouseDown","_onDocumentTouchMove","_onDocumentTouchEnd","_onDocumentTouchCancel","_onDocumentMouseMove","_onDocumentMouseUp","_onWindowResize","_onDocumentKeydown"])},_bindEvents:function(){var a=this.bControl,b=(this.btnPrev,this.btnNext,this.bThumbs);this._bindEvent(a,"touchstart",this._onBControlTouchStart),this._bindEvent(a,"mousedown",this._onBControlMouseDown),this._bindEvent(b,"touchstart",this._onBThumbsTouchStart),this._bindEvent(b,"mousedown",this._onBThumbsMouseDown),this._bindEvent(window,"resize",this._onWindowResize),this._bindEvent(document,"keydown",this._onDocumentKeydown)},_onBControlTouchStart:function(a){this._handleTouchStart(a,this.bControl,!0)},_onBControlMouseDown:function(a){1==a.which&&this._handleTouchStart(a,this.bControl,!1)},_onBThumbsTouchStart:function(a){this._handleTouchStart(a,this.bThumbs,!0)},_onBThumbsMouseDown:function(a){this._handleTouchStart(a,this.bThumbs,!1)},_handleTouchStart:function(b,c,d){if(!this.frozen&&!this.touch){var e=d?b.touches[0]:b;this._touch={id:d?b.touches[0].identifier:a,start:{clientX:e.clientX,clientY:e.clientY,time:b.timeStamp,element:c}},this._observeTouch()}},_observeTouch:function(a){a?(this._bindEvent(document,"touchmove",this._onDocumentTouchMove),this._bindEvent(document,"touchend",this._onDocumentTouchEnd),this._bindEvent(document,"touchcancel",this._onDocumentTouchCancel)):(this._bindEvent(document,"mousemove",this._onDocumentMouseMove),this._bindEvent(document,"mouseup",this._onDocumentMouseUp))},_stopTouchObserving:function(a){a?(this._unbindEvent(document,"touchmove",this._onDocumentTouchMove),this._unbindEvent(document,"touchend",this._onDocumentTouchEnd),this._unbindEvent(document,"touchcancel",this._onDocumentTouchCancel)):(this._unbindEvent(document,"mousemove",this._onDocumentMouseMove),this._unbindEvent(document,"mouseup",this._onDocumentMouseUp))},_onDocumentTouchMove:function(a){this._handleTouchMove(a,!0)},_onDocumentTouchEnd:function(a){this._handleTouchEnd(a,!0)},_onDocumentTouchCancel:function(a){this._completeTouch(a,!0,"touchCancel")},_onDocumentMouseMove:function(a){this._handleTouchMove(a,!1)},_onDocumentMouseUp:function(a){this._handleTouchEnd(a,!1)},_onWindowResize:function(){this.update()},_onDocumentKeydown:function(){document.activeElement==document.body},_handleTouchMove:function(b,c){var d=this._touch;if(d){var e=d.start,f=d.clientX===a?e:d;d.prev={clientX:f.clientX,clientY:f.clientY,time:f.time};var g=c?b.touches.identifiedTouch(d.id):b;if(d.clientX=g.clientX,d.clientY=g.clientY,d.shiftX=d.clientX-e.clientX,d.shiftY=d.clientY-e.clientY,d.time=b.timeStamp,c&&b.touches.length>1)return void this._completeTouch(b,!0,"multitouch");var h,i=this._params,j=this._drag,k=this.element,l=this.bControl,m=this.bViewportLayer,n=this.bThumbsLayer;if(j)h=j.targetLayer;else{if(c&&Math.abs(d.shiftX)<Math.abs(d.shiftY))return void this._completeTouch(b,!0,"scroll");h=e.element==l?m:n,j=this._drag={start:{targetLayerOffset:G(h)},targetLayer:h}}b.preventDefault();var o=!1;if(h==m?t&&(z(k,i._dragging),o=!0):this._thumbsDraggable&&(o=!0),o){var p=j.start.targetLayerOffset+d.shiftX;if(p>0)p/=3;else if(0>p){var q=h==m?-(this._bViewportWidth*(this._items.length-1)):this._bThumbsWidth-this._bThumbsLayerWidth;q>p&&(p=q+(p-q)/3)}u&&(h.style[u]="0s"),h==n&&(this._thumbsOffset=p),H(h,p)}}},_handleTouchEnd:function(a,b){this._completeTouch(a,b,"touchEnd")},_completeTouch:function(a,b,c){this._stopTouchObserving();var d,e=this._touch,f=e.start,g=this._drag,h=this.bControl,i=this.btnPrev,j=this.btnNext,l=(this.bThumbsLayer,e.end={});b?a.touches?(d=a.touches.identifiedTouch(e.id),l.time=a.timeStamp):(d=e.prev||f,l.time=d.time):(d=a,l.time=a.timeStamp),l.clientX=d.clientX,l.clientY=d.clientY,l.shiftX=d.clientX-f.clientX,l.shiftY=d.clientY-f.clientY,g?f.element==h?"touchEnd"==c?this._completeSlidesDrag():this._moveToCurrentSlide():Math.abs(l.shiftX)>5||Math.abs(l.shiftY)>5?this._completeThumbsDrag():this._handleThumbsTap(a):"touchEnd"==c&&(f.element==h?k(a.target,i,h)?(a.preventDefault(),this.prev()):k(a.target,j,h)&&(a.preventDefault(),this.next()):this._handleThumbsTap(a)),this._touch=null,this._drag=null},_completeSlidesDrag:function(){var a=this._touch,b=a.start,c=a.end;if(c.time-b.time<300||Math.abs(c.shiftX)>=this._bControlWidth/4)if(c.shiftX>0){if(this.canPrev())return void this.prev()}else if(this.canNext())return void this.next();this._moveToCurrentSlide()},_completeThumbsDrag:function(){var a,b=this._params,c=this._touch,d=c.prev,e=c.end,f=this.bThumbsLayer;if(this._thumbsDraggable){var g=e.clientX-d.clientX,h=0>g?-1:1,i=Math.abs(g/(e.time-d.time));if(a=h*Math.pow(10*i,2)+this._thumbsOffset,a>0)a=0;else{var j=this._bThumbsWidth-this._bThumbsLayerWidth;j>a&&(a=j)}}else a=0;this._thumbsOffset=a,u&&(f.style[u]=b.duration+"ms"),H(f,a)},_handleThumbsTap:function(a){for(var b=this.bThumbs,c=a.target;c!=b;){if(c.hasAttribute("data-rel")){a.preventDefault(),this.go(+c.getAttribute("data-rel"));break}if(!(c=c.parentNode))break}},update:function(){this._updateDims(),this._updateThumbsDims(),this._moveToCurrent(!0)},go:function(a){var b=this.current;a==b||0>a||a>this._items.length-1||(this.current=a,this._loadActualSlides(),this._moveToCurrent())},canPrev:function(){return this.current>0},canNext:function(){return this.current<this._items.length-1},prev:function(){this.go(this.current-1)},next:function(){this.go(this.current+1)},freeze:function(){},unfreeze:function(){},_bindEvent:function(a,b,c){var e=d(a)+"-"+b+"-"+d(c);if(!this._events.hasOwnProperty(e))if(a.addEventListener)a.addEventListener(b,c,!1),this._events[e]={element:a,type:b,listener:c};else{var f=function(b){c.call(a,p(b||window.event))};f._inner=c,a.attachEvent("on"+b,f),this._events[e]={element:a,type:b,listener:f}}},_bindTransitionEnd:function(a,b){for(var c=["transitionend","webkitTransitionEnd","MSTransitionEnd","oTransitionEnd"],d=0,e=c.length;e>d;d++)this._bindEvent(a,c[d],b)},_unbindEvent:function(a,b,c){var e=d(a)+"-"+b+"-"+d(c);this._events.hasOwnProperty(e)&&(a.removeEventListener?a.removeEventListener(b,c,!1):a.detachEvent("on"+b,this._events[e].listener),delete this._events[e])},destroy:function(){var a=this._events;for(var b in a)if(a.hasOwnProperty(b)){var c=a[b];c.element.removeEventListener?c.element.removeEventListener(c.type,c.listener,!1):c.element.detachEvent("on"+c.type,c.listener),delete a[b]}this.element._photor=null}};var y,z,A,B=0,C=/\S+/g,D=Object.create||function(a){function b(){}return b.prototype=a,new b},E=Array.isArray||function(a){return"[object Array]"==Object.prototype.toString.call(a)},F=Function.prototype.bind?function(a,b){for(var c=b.length;c;)a[b[--c]]=a[b[c]].bind(a)}:function(a,b){for(var c=b.length;c;)!function(a,b){var c=a[b];a[b]=function(){return c.apply(a,arguments)}}(a,b[--c])};q.classList?(y=function(a,b){return a.classList.contains(b)},z=function(a,b){a.classList.add(b)},A=function(a,b){a.classList.remove(b)}):(y=function(a,b){return-1!=(a.className.match(C)||[]).indexOf(b)},z=function(a,b){var c=a.className.match(C)||[];-1==c.indexOf(b)&&(c.push(b),a.className=c.join(" "))},A=function(a,b){var c=a.className.match(C)||[],d=c.indexOf(b);-1!=d&&(c.splice(d,1),a.className=c.join(" "))});var G,H,I;t?(G=function(a){var b=window.getComputedStyle(a,null)[t].match(/\-?[0-9\.]+/g);return parseFloat(b[b.length>6?13:4],10)},H=function(b,c,d){d===a&&(d="px"),b.style[t]="translate("+c+d+", 0)"+(v?" translateZ(0)":"")},I=function(b,c,d,e){e===a&&(e="px"),b.style[t]="translate("+c+e+", "+d+e+")"+(v?" translateZ(0)":"")}):(G=function(a){var b=window.getComputedStyle?window.getComputedStyle(a,null):a.currentStyle;return parseFloat(b.left,10)},H=function(b,c,d){d===a&&(d="px"),b.style.left=c+d},I=function(b,c,d,e){e===a&&(e="px"),b.style.top=d+e,b.style.left=c+e}),q=null,r=null,"function"==typeof jQuery&&(jQuery.fn.photor=function(c,d){return c===a?new b(this[0],d):void $.error("Unknown method: "+c)})}}();