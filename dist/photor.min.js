!function(a){function b(){var a=navigator.userAgent.toLowerCase();return a.indexOf("msie")>-1?parseInt(a.split("msie")[1]):!1}function c(){var a=!1,b=document.createElement("p");for(var c in p)if(p.hasOwnProperty(c)&&void 0!==b.style[c]){a={property:c};break}return document.body.appendChild(b),a.property&&(b.style[a.property]="translate3d(1px,1px,1px)",a.has3d="none"!=window.getComputedStyle(b).getPropertyValue(p[a.property])),document.body.removeChild(b),a}function d(a){var b=document.createElement("p").style,c=["ms","O","Moz","Webkit"];if(""==b[a])return a;a=a.charAt(0).toUpperCase()+a.slice(1);for(var d=0,e=c.length;e>d;d++)if(""==b[c[d]+a])return c[d]+a}function e(b,c,d,e,f){e=!!e,b&&(f?b.removeEventListener?b.removeEventListener(c,d,e):a(b).off(c):b.addEventListener?b.addEventListener(c,d,e):a(b).on(c,d))}function f(a,b){var c=" "+a.className+" ";return b=" "+b+" ",c.replace(/[\r\n\t\f]+/g," ").indexOf(b)>-1?!0:!1}function g(){var a="ontouchstart"in window;return a?["touchstart","touchmove","touchend","touchcancel"]:["mousedown","mousemove","mouseup","mouseleave"]}function h(a){function b(a){var b,c=q[a];if(c.params.transform){var d=c.layer.css(p[c.params.transform.property]).match(/(-?[0-9\.]+)/g);b=d.length>6?d[13]:d[4]}else b=c.layer.css("left");return parseInt(b)}function c(){l.isSlide&&(l.isThumbs?h():j.params.transition&&e()),l={},j.root.removeClass(j.params._dragging)}function d(){var b,c=j.params.slidesOnScreen;(0==j.current&&l.shiftX>0||j.current+c-1==j.last&&l.shiftX<0)&&(l.shiftX=l.shiftX/3),b=l.shiftX+l.startShift,j.layer.css(t.setIndent(a,Math.round(b),"px"))}function e(){if(Math.abs(l.shiftX)>.05*j.controlWidth){var b,c=l.shiftX/j.controlWidth*j.params.slidesOnScreen;b=l.shiftX<0?j.current-Math.floor(c):j.current-Math.ceil(c),0>b&&(b=0),b+j.params.slidesOnScreen-1>j.last&&(b=j.last-j.params.slidesOnScreen+1),t.go(a,b)}else t.go(a,j.current)}function g(){var b=l.shiftX+l.thumbsStartX,c=-1*(j.thumbsLayerWidth-j.thumbsWidth);b>0&&(b/=3),c>b&&(b=c+(b-c)/3),j.thumbsIndent=b,j.thumbsLayer.css(t.setIndent(a,j.thumbsIndent,"px"))}function h(){if(j.thumbsDragging&&l.isSlide){var b=l.shiftX<0?-1:1;l.t2=new Date,j.thumbsIndent=i(j.thumbsIndent,b),j.thumbsLayer.css("transition-duration",".24s").css(t.setIndent(a,j.thumbsIndent,"px"))}}function i(a,b){var c,d,e=Math.abs(10*l.shiftX/(l.t2-l.t1));return c=b*parseInt(Math.pow(e,2))+a,d=j.thumbs.outerWidth()-j.thumbsLayer.outerWidth(),c>0?0:d>c?d:c}var j=q[a],k=(j.control,j.thumbs),l={};s.onStart=function(a){j.freeze||(l.x1=a.clientX||a.touches&&a.touches[0].clientX,l.y1=a.clientY||a.touches&&a.touches[0].clientY,l.t1=new Date,l.isPressed=!0,l.isThumbs=f(this,j.params.thumbs),l.thumbsStartX=j.thumbsIndent,j.layer.css("transition-duration","0s"),j.thumbsLayer.css("transition-duration","0s"))},s.onMove=function(e){if(l.isPressed&&!j.freeze){if(l.shiftX=(e.clientX||e.touches&&e.touches[0].clientX)-l.x1,l.shiftY=(e.clientY||e.touches&&e.touches[0].clientY)-l.y1,l.shiftXAbs=Math.abs(l.shiftX),l.shiftYAbs=Math.abs(l.shiftY),l.isMultitouch=l.isMultitouch||!!e.touches&&e.touches.length>1,l.isMultitouch)return void c();l.isSlide||l.isScroll||(l.shiftYAbs>=5&&l.shiftYAbs>l.shiftXAbs&&(l.isScroll=!0),l.shiftXAbs>=5&&l.shiftXAbs>l.shiftYAbs&&(j.root.addClass(j.params._dragging),l.isSlide=!0,l.startShift=b(a))),l.isSlide&&(l.isThumbs?j.thumbsDragging&&g():j.params.transition&&d(),e.preventDefault&&e.preventDefault())}},s.onEnd=function(b){if(!l.isSlide&&!l.isScroll&&l.isPressed){if(f(b.target,j.params.prev)&&t.prev(a),f(b.target,j.params.next)&&t.next(a),f(b.target,j.params.thumbImg)||f(b.target,j.params.thumb)){var d=parseInt(b.target.getAttribute("data-rel"));d+j.params.slidesOnScreen-1>j.last&&(d=j.last-j.params.slidesOnScreen+1),t.go(a,d)}b.stopPropagation&&b.preventDefault&&(b.stopPropagation(),b.preventDefault())}c()},j.events.push({element:j.viewport[0],event:r[0],handler:s.onStart},{element:j.viewport[0],event:r[1],handler:s.onMove,capture:!0},{element:j.viewport[0],event:r[2],handler:s.onEnd},{element:j.viewport[0],event:r[3],handler:s.onEnd},{element:k[0],event:r[0],handler:s.onStart},{element:k[0],event:r[1],handler:s.onMove,capture:!0},{element:k[0],event:r[2],handler:s.onEnd},{element:k[0],event:r[3],handler:s.onEnd});for(var m=0,n=j.thumb.length;n>m;m++)j.events.push({element:j.thumb[m],event:"click",handler:function(a){return a.preventDefault&&a.preventDefault(),!1}});for(var o=0,u=j.thumbImg.length;u>o;o++)j.events.push({element:j.thumbImg[o],event:"dragstart",handler:function(a){return a.preventDefault&&a.preventDefault(),!1}})}function i(a){if(!s.resize){var b=q[a];b.events.push({element:window,event:"resize",handler:t.update})}}function j(a){var b=q[a];s.keydown=function(b){var c=b.which||b.keyCode,d=b.target.nodeName.toLowerCase(),e=!!b.target.attributes.contenteditable;if("input"!=d&&"textarea"!=d&&"select"!=d&&!e)switch(c){case 32:t.next(a);break;case 37:t.prev(a);break;case 39:t.next(a)}},b.events.push({element:window,event:"keydown",handler:s.keydown})}function k(a){var b=q[a],c=["webkitTransitionEnd","MSTransitionEnd","oTransitionEnd","transitionend"];s.transitionEnd=function(b){var c=b.propertyName;(c.lastIndexOf("transform")==c.length-"transform".length||"left"==c)&&l(a)};for(var d=0,e=c.length;e>d;d++)b.events.push({element:b.layer[0],event:c[d],handler:s.transitionEnd})}function l(a){var b=q[a];b.root.removeClass(b.params._animated),b.layer[0].style.transitionDuration=0,m(a,b.current),b.params.onShow&&b.params.onShow(b)}function m(a,b){for(var c=q[a],d=0,e=c.count;e>d;d++){var f=c.root.find("."+c.params.slide+"."+c.params.modifierPrefix+d),g=c.params.slidesOnScreen;d>=c.current-g&&d<=c.current+2*g-1||d>=b-g&&b+2*g-1>=d?f.removeClass(c.params._hidden):f.addClass(c.params._hidden)}}function n(a,b){var c=new Image;c.onload=c.onerror=function(d){c.onload=c.onerror=null,b("load"==d.type,a)},c.src=a}if("undefined"!=typeof window){var o,p={transform:"transform",WebkitTransform:"-webkit-transform",MozTransform:"-moz-transform",msTransform:"-ms-transform",OTransform:"-o-transform"},q=[],r=g(),s=[],t={init:function(e){var f="photor__";return o=a.extend({control:f+"viewportControl",next:f+"viewportControlNext",prev:f+"viewportControlPrev",thumbs:f+"thumbs",thumbsLayer:f+"thumbsWrap",thumb:f+"thumbsWrapItem",thumbImg:f+"thumbsWrapItemImg",thumbFrame:f+"thumbsWrapFrame",viewport:f+"viewport",layer:f+"viewportLayer",slide:f+"viewportLayerSlide",slideImg:f+"viewportLayerSlideImg",_loading:"_loading",_current:"_current",_dragging:"_dragging",_disabled:"_disabled",_alt:"_alt",_single:"_single",_animated:"_animated",_hidden:"_hidden",_html:"_html",_freeze:"_freeze",_auto:"_auto",_center:"_center",_portrait:"_portrait",_landscape:"_landscape",_draggable:"_draggable",single:!1,current:0,count:0,last:-1,delay:300,loop:!1,showThumbs:"thumbs",keyboard:!0,modifierPrefix:"_",ieClassPrefix:"_ie",slidesOnScreen:1,transform:c(),transition:d("transition"),ie:b()},e),this.each(function(){var b=a(this),c=this.id||q.length,d={},e={},f={url:"",thumb:"",caption:"",width:0,height:0,loaded:!1,classes:""},g=!1;if(!b.attr("data-photor-id")){if(d.params=a.extend({},o),d.root=b,d.control=b.find("."+d.params.control),d.next=b.find("."+d.params.next),d.prev=b.find("."+d.params.prev),d.thumbs=b.find("."+d.params.thumbs),d.thumbsLayer=b.find("."+d.params.thumbsLayer),d.viewport=b.find("."+d.params.viewport),d.layer=b.find("."+d.params.layer),d.gallery=[],d.params.data&&d.params.data.length)for(var h=0,i=d.params.data.length;i>h;h++)d.gallery.push(a.extend({},f,d.params.data[h]));else{var j=b.find("."+d.params.layer+" > *");j.length&&j.each(function(){var b="IMG"==this.nodeName;b?d.gallery.push(a.extend({},f,{url:this.src,caption:this.alt,thumb:a(this).data("thumb"),classes:this.className})):(g=!0,d.gallery.push(a.extend({},f,{html:this.outerHTML,loaded:!0})))})}g&&"thumbs"==d.params.showThumbs&&(d.params.showThumbs="dots"),1!=d.params.slidesOnScreen&&(d.params.showThumbs=null),e=t.getHTML(d.params,d.gallery),d.layer.html(e.slides),d.thumbsLayer.html(e.thumbs),d.thumb=b.find("."+d.params.thumb),d.thumbImg=b.find("."+d.params.thumbImg),d.thumbFrame=b.find("."+d.params.thumbFrame),d.slide=b.find("."+d.params.slide),d.slideImg=b.find("."+d.params.slideImg),d.slide.each(function(b){a(this).css("left",100*b+"%")}),d.current=d.params.current,d.count=d.gallery.length,d.last=d.count-1,d.thumbsDragging=!1,d.thumbsIndent=0,d.events=[],d.viewportWidth=window.getComputedStyle?parseFloat(window.getComputedStyle(d.viewport[0]).width):d.viewport.outerWidth(),d.viewportHeight=d.viewport.outerHeight(),d.controlWidth=d.control.outerWidth(),d.controlHeight=d.control.outerHeight(),d.thumbsWidth=d.thumbs.outerWidth(),d.thumbsHeight=d.thumbs.outerHeight(),q[c]=d,b.attr("data-photor-id",c),d.params.showThumbs&&b.addClass(d.params.modifierPrefix+d.params.showThumbs),d.params.ie&&b.addClass(d.params.ieClassPrefix+d.params.ie),1==d.gallery.length&&b.addClass(d.params._single),"thumbs"==d.params.showThumbs&&t.loadThumbs(c),(d.gallery.length>1||d.params.single)&&t.handlers(c),t.go(c,d.current,0),l(c)}})},update:function(){function a(a){var b=q[a];b.viewportWidth=window.getComputedStyle?parseFloat(window.getComputedStyle(b.viewport[0]).width):b.viewport.outerWidth(),b.viewportHeight=b.viewport.outerHeight(),b.controlWidth=b.control.outerWidth(),b.controlHeight=b.control.outerHeight(),b.thumbsWidth=b.thumbs.outerWidth(),b.thumbsHeight=b.thumbs.outerHeight(),b.thumbsLayerWidth=b.thumbsLayer.outerWidth(),b.slide.each(function(b){t.position(a,b)}),"thumbs"==b.params.showThumbs&&t.getThumbsSize(a),b.layer.css("transition-duration","0s").css(t.setIndent(a,-100*b.current))}for(var b in q)q.hasOwnProperty(b)&&a(b)},destroy:function(a){function b(a){for(var b=q[a],c=0,d=b.events.length;d>c;c++)e(b.events[c].element,b.events[c].event,b.events[c].handler,b.events[c].capture,1)}if("undefined"!=typeof a)b(a);else for(var c in q)q.hasOwnProperty(c)&&b(c)},handlers:function(a){var b=q[a];h(a),i(a),k(a),b.params.keyboard&&j(a);for(var c=0,d=b.events.length;d>c;c++)e(b.events[c].element,b.events[c].event,b.events[c].handler,b.events[c].capture)},go:function(a,b,c){var d=q[a];d.freeze||(m(a,b),c=null==c?d.params.delay:c,d.root.addClass(d.params._animated),d.layer.css("transition-duration",c+"ms").css(t.setIndent(a,-b*(d.viewportWidth/d.params.slidesOnScreen),"px")),d.current=b,t.loadSlides(a,b),t.checkButtons(a),t.setCurrentThumb(a,b),d.slide.removeClass(d.params._current),d.slide.filter("."+d.params.modifierPrefix+b).addClass(d.params._current),d.params.transition||l(a))},next:function(a){var b=q[a];b.current+b.params.slidesOnScreen-1<b.last?t.go(a,b.current+1):t.go(a,b.params.loop?0:b.current)},prev:function(a){var b=q[a];b.current>0?t.go(a,b.current-1):t.go(a,b.params.loop?b.last:0)},loadSlides:function(a,b){for(var c=q[a],d=c.params.slidesOnScreen,e=0>b-d?0:b-d,f=b+2*d-1>c.last?c.last:b+2*d-1,g=e;f>=g;g++)c.gallery[g]&&!c.gallery[g].loaded&&t.loadSlide(a,g)},loadSlide:function(b,c){var d=q[b],e=d.root.find("."+d.params.slide+"."+d.params.modifierPrefix+c),f=e.find("."+d.params.slideImg),g=d.gallery[c].caption;n(d.gallery[c].url,function(g,h){g?(d.gallery[c].loaded=!0,d.gallery[c].width=this.width,d.gallery[c].height=this.height,t.position(b,c),d.params.ie&&d.params.ie<9?f.attr("src",h):f.css("background-image","url("+h+")"),e.removeClass(d.params._loading)):a.error("Image wasn't loaded: "+h)}),g&&f.addClass(d.params._alt).attr("data-alt",g)},loadThumbs:function(b){var c=q[b],d=c.count,e=c.gallery,f=0;c.galleryThumbs=[],c.galleryThumbsLoaded=!1;for(var g=0;d>g;g++)n(e[g].thumb,function(e,g){e?(f++,f==d&&(c.galleryThumbsLoaded=!0,t.getThumbsSize(b))):a.error("Image wasn't loaded: "+g)})},getThumbsSize:function(b){var c=q[b],d=c.thumb;d.each(function(b){var d=a(this);c.galleryThumbs[b]={},c.galleryThumbs[b].width=d.outerWidth(),c.galleryThumbs[b].height=d.outerHeight(),c.galleryThumbs[b].top=d.position().top+parseInt(d.css("margin-top")),c.galleryThumbs[b].left=d.position().left+parseInt(d.css("margin-left"))}),c.thumbsLayerWidth=c.thumbsLayer.outerWidth(),t.setCurrentThumb(b,c.current,1)},setCurrentThumb:function(a,b,c){function d(a){if(a>0||!e.thumbsDragging)return 0;var b=k-l;return b>a?b:a}var e=q[a];if("thumbs"==e.params.showThumbs){var f,g,h=e.thumbFrame,i={},j=e.galleryThumbs&&e.galleryThumbs[b],k=e.thumbs.outerWidth(),l=e.thumbsLayer.outerWidth(),m=c?"0s":.8*e.params.delay/1e3+"s";if(e.thumbsDragging=l>k,e.galleryThumbsLoaded){if(i.width=j.width+"px",i.height=j.height+"px",e.params.transform){var n=p[e.params.transform.property];i[n]=e.params.transform.has3d?"translate3d("+j.left+"px, "+j.top+"px, 0)":"translateX("+j.left+"px) translateY("+j.top+"px)"}else i.top=j.top+"px",i.left=j.left+"px";f=.5*(k-j.width)-j.left,g=d(f),e.thumbsIndent=g,h.css("transition-duration",m).css(i),e.thumbsLayer.css("transition-duration",m).css(t.setIndent(a,g,"px"))}}e.thumb.removeClass(e.params._current),e.thumb.filter("."+e.params.modifierPrefix+b).addClass(e.params._current)},position:function(a,b){var c=q[a],d=c.root.find("."+c.params.slide+"."+c.params.modifierPrefix+b),e=c.gallery[b],f=c.viewportWidth/c.viewportHeight,g=e.width/e.height;c.viewportWidth>e.width&&c.viewportHeight>e.height?(c.gallery[b].algorithm="center",d.removeClass(c.params._auto).addClass(c.params._center)):(c.gallery[b].algorithm="auto",d.removeClass(c.params._center).addClass(c.params._auto)),g>=f?(c.gallery[b].orientation="landscape",d.removeClass(c.params._portrait).addClass(c.params._landscape)):(c.gallery[b].orientation="portrait",d.removeClass(c.params._landscape).addClass(c.params._portrait))},checkButtons:function(a){var b=q[a];0==b.current?b.prev.addClass(b.params._disabled):b.prev.removeClass(b.params._disabled),b.current+b.params.slidesOnScreen-1==b.last?b.next.addClass(b.params._disabled):b.next.removeClass(b.params._disabled)},setIndent:function(a,b,c){var d=q[a],e={};if(c=c||"%",d.params.transform){var f=p[d.params.transform.property];e[f]=d.params.transform.has3d?"translate3d("+b+c+", 0, 0)":"translateX("+b+c+")"}else e.left=b+c;return e},freeze:function(a){var b=q[a];b.freeze=!0,b.root.addClass(b.params._freeze)},unfreeze:function(a){var b=q[a];b.freeze=!1,b.root.removeClass(b.params._freeze)},getHTML:function(a,b){for(var c="",d="",e=0,f=b.length;f>e;e++)c+='<span data-rel="'+e+'" class="'+a.thumb+" "+a.modifierPrefix+e+" "+b[e].classes+'">',"thumbs"==a.showThumbs&&b[e].url&&(c+='<img src="'+b[e].thumb+'" class="'+a.thumbImg+'" data-rel="'+e+'">'),c+="</span>",d+='<div class="'+a.slide+" "+a.modifierPrefix+e+" "+(b[e].html?a._html:a._loading)+'" data-id="'+e+'">',d+=b[e].html?b[e].html:a.ie&&a.ie<9?'<img src="" class="'+a.slideImg+" "+b[e].classes+'" />':'<div class="'+a.slideImg+" "+b[e].classes+'"></div>',d+="</div>";return"thumbs"==a.showThumbs&&(c+='<div class="'+a.thumbFrame+'"></div>'),{thumbs:c,slides:d}}};a.fn.photor=function(b){return t[b]?t[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Unknown method: "+b):t.init.apply(this,arguments)},a.fn.photor.data=q}}(jQuery);