!function(a){"use strict";function b(){for(var a in e)if(void 0!==document.createElement("div").style[a])return a;return!1}if(window){var c,d,e={transform:"transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",WebkitTransform:"-webkit-transform"},f=[],g={init:function(d){return c=a.extend({current:0,count:0,loadingRange:1,slideIdPrefix:"_",transform:b()},d),this.each(function(b){var d=a(this),e=this.id||b,h={},i="",j=0;h.root=d,h.control=d.find("."+c.control),h.next=d.find("."+c.next),h.prev=d.find("."+c.prev),h.thumb=d.find("."+c.thumb),h.thumbImg=d.find("."+c.thumbImg),h.viewport=d.find("."+c.viewport),h.layer=d.find("."+c.layer),h.gallery=[],h.thumb.each(function(b){h.gallery.push({url:this.href,width:0,height:0,loaded:!1}),i+=g.getTemplate(b),j++,a(this).attr("data-rel",b).addClass(c.slideIdPrefix+b)}),h.layer.html(i),h.slide=d.find("."+c.slide),h.current=c.current,h.count=j-1,h.dragging=!1,h.allowClick=!0,h.viewportWidth=h.viewport.outerWidth(),h.viewportHeight=h.viewport.outerHeight(),f[e]=h,g.handlers(e),g.go(e,h.current,0)})},destroy:function(){a("."+c.next).off(),a("."+c.prev).off(),a("."+c.thumb).off()},handlers:function(b){function d(){new Date-h<j?setTimeout(d,j):(i=!1,e.viewportWidth=e.viewport.outerWidth(),e.viewportHeight=e.viewport.outerHeight(),e.slide.each(function(a){g.position(b,a)}))}var e=f[b],h=new Date(1,1,2e3,12,0,0),i=!1,j=84;e.next.on("click",function(){e.allowClick&&g.next(b)}),e.prev.on("click",function(){e.allowClick&&g.prev(b)}),e.thumb.on("click",function(){var c=parseInt(a(this).attr("data-rel"));return g.go(b,c),!1}),c.swipe&&g.bindSwipe(b),c.keyboard&&g.bindKeyboard(b),a(window).on("resize",function(){h=new Date,i===!1&&(i=!0,setTimeout(d,j))})},bindSwipe:function(b){var d,e=f[b],h={},i={},j=!1;e.dragging=!1,e.control.on("mousedown touchstart",function(b){a(this).offset();return h={x:b.pageX||b.touches[0].pageX,y:b.pageY||b.touches[0].pageY},i={x:0,y:0},"touchstart"==b.type?!0:(e.dragging=!0,void e.root.addClass(c.mod.dragging))}).on("mousemove touchmove",function(b){var f=b.touches&&b.touches.length,k=b.pageX||b.touches[0].pageX,l=b.pageY||b.touches[0].pageY;if(i={x:h.x-k,y:h.y-l},"undefined"==typeof d&&(d=!!(d||Math.abs(i.x)<Math.abs(i.y))),j=j||f>1,!d&&!j&&0!=f&&(b.preventDefault(),"touchmove"!=b.type||e.dragging||(e.dragging=!0,e.root.addClass(c.mod.dragging)),e.dragging)){e.allowClick=!1;var m,n,o=a(this),p=o.outerWidth();m=-i.x/p*100,n=100*-e.current+m,e.layer.css(g.setIndent(n))}}).on("mouseup mouseleave touchend touchcancel",function(f){if(e.root.removeClass(c.mod.dragging),d=void 0,j=1==(f.touches&&f.touches.length),e.dragging){var h,k=a(this),l=k.outerWidth();if(e.dragging=!1,0==i.x)return e.allowClick=!0,!0;e.allowClick=!1,setTimeout(function(){e.allowClick=!0},20),h=i.x>0?e.current+1:e.current-1,Math.abs(i.x)>.05*l?i.x>0?g.next(b):g.prev(b):g.go(b,e.current)}})},bindKeyboard:function(b){f[b];a(window).on("keydown",function(){var a=event.which||event.keyCode;switch(a){case 32:g.next(b);break;case 37:g.prev(b);break;case 39:g.next(b)}})},go:function(a,b,e){var h=f[a];void 0===e&&(e=c.delay),h.layer.css("transition-duration",e+"ms").css(g.setIndent(100*-b)),h.current=b,h.slide.removeClass(c.mod.current),h.slide.filter(c.slideIdPrefix+b).addClass(c.mod.current),g.loadSlides(a,b),clearTimeout(d),d=setTimeout(function(){h.layer.css("transition-duration","0s")},e)},next:function(a){var b=f[a];b.current<b.count?g.go(a,b.current+1):g.go(a,b.current)},prev:function(a){var b=f[a];b.current>0?g.go(a,b.current-1):g.go(a,b.current)},loadSlides:function(a,b){for(var d=f[a],e=(c.loadingRange,0>b-1?0:b-1),h=b+1>d.count?d.count:b+1,i=e;h>=i;i++)d.gallery[i].loaded||g.loadSlide(a,i)},loadSlide:function(b,d){var e=f[b],h=e.root.find("."+c.slide+"."+c.slideIdPrefix+d),i=e.gallery[d].url,j=document.createElement("img");!function(d){var f=a(j);f.on("load",function(){e.gallery[d].loaded=!0,e.gallery[d].width=this.width,e.gallery[d].height=this.height,h.removeClass(c.mod.loading),g.position(b,d)}).on("error",function(){}),j.src=i,h.css("background-image","url("+j.src+")")}(d)},position:function(a,b){var d=f[a],e=d.root.find("."+c.slide+"."+c.slideIdPrefix+b),g=d.gallery[b],h=d.viewportWidth/d.viewportHeight,i=g.width/g.height;d.viewportWidth>g.width&&d.viewportHeight>g.height?e.removeClass(c.mod.auto).addClass(c.mod.center):e.removeClass(c.mod.center).addClass(c.mod.auto),i>=h?e.removeClass(c.mod.portrait).addClass(c.mod.landscape):e.removeClass(c.mod.landscape).addClass(c.mod.portrait)},setIndent:function(a){var b={};return c.transform?b[e[c.transform]]="translate3d("+a+"%, 0, 0)":b.left=a+"%",b},getTemplate:function(a){return'<div class="'+c.slide+" "+c.slideIdPrefix+a+" "+c.mod.loading+'" data-id="'+a+'"></div>'}};a.fn.photor=function(b){return g[b]?g[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Unknown method: "+b):g.init.apply(this,arguments)}}}(jQuery);