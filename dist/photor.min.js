!function(a){function b(){for(var a in f)if(void 0!==document.createElement("div").style[a])return a;return!1}function c(){var a=navigator.pointerEnabled,b=!!("ontouchstart"in window),c=["pointerdown","pointermove","pointerup","pointerleave"],d=["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut"],e=["touchstart","touchmove","touchend","touchcancel"],f=["mousedown","mousemove","mouseup","mouseleave"];return a?c:h?d:b?e:f}if(window){var d,e,f={transform:"transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",WebkitTransform:"-webkit-transform"},g=[],h=navigator.msPointerEnabled,i=c(),j=!1;!function(){var a={},b={},c=!1;Element.prototype.addEventListener&&(j=!0,document.addEventListener(i[0],function(b){var d=b.pageX||touches[0].pageX,e=b.pageY||touches[0].pageY;a={x:d,y:e},c=!0},!1),document.addEventListener(i[1],function(a){var d=a.originalEvent&&a.originalEvent.touches,e=a.pageX||d[0].pageX,f=a.pageY||d[0].pageY;b={x:e,y:f},c=!1},!0),document.addEventListener(i[2],function(d){if(c||Math.abs(a.x-b.x)<20&&Math.abs(a.y-b.y)<20){c=!1;var e=document.createEvent("CustomEvent");e.initCustomEvent("fastclick",!0,!0,d.target),d.target.dispatchEvent(e),d.preventDefault()}},!1))}();var k={init:function(c){return d=a.extend({current:0,count:0,loadingRange:2,slideIdPrefix:"_",transform:b()},c),this.each(function(b){var c=a(this),e=this.id||b,f={},h="",i=0,j=[];f.root=c,f.control=c.find("."+d.control),f.next=c.find("."+d.next),f.prev=c.find("."+d.prev),f.thumbs=c.find("."+d.thumbs),f.thumbsLayer=c.find("."+d.thumbsLayer),f.thumb=c.find("."+d.thumb),f.thumbImg=c.find("."+d.thumbImg),f.thumbFrame=c.find("."+d.thumbFrame),f.viewport=c.find("."+d.viewport),f.layer=c.find("."+d.layer),f.gallery=[],f.thumb.each(function(b){var c=a(this),e=c.find("."+d.thumbImg)[0];f.gallery.push({url:this.href,width:0,height:0,loaded:!1}),h+=k.getTemplate(b),i++,c.attr("data-rel",b).addClass(d.slideIdPrefix+b),j[b]=e.src}),f.layer.html(h),f.slide=c.find("."+d.slide),f.current=d.current,f.count=i-1,f.dragging=!1,f.thumbsDragging=!1,f.allowClick=!0,f.viewportWidth=f.viewport.outerWidth(),f.viewportHeight=f.viewport.outerHeight(),f.thumbSrc=j,g[e]=f,k.loadThumbs(e),k.handlers(e),k.go(e,f.current,0)})},destroy:function(){a("."+d.next).off(),a("."+d.prev).off(),a("."+d.thumb).off()},handlers:function(b){function c(){new Date-f<i?setTimeout(c,i):(h=!1,e.viewportWidth=e.viewport.outerWidth(),e.viewportHeight=e.viewport.outerHeight(),e.slide.each(function(a){k.position(b,a)}),k.setCurrentThumb(b,e.current,1))}var e=g[b],f=new Date(1,1,2e3,12,0,0),h=!1,i=84,l=j?"fastclick":"click";d.swipe&&k.bindSwipe(b),e.next.on(l,function(a){k.next(b),a.stopPropagation()}),e.prev.on(l,function(a){k.prev(b),a.stopPropagation()}),e.thumb.on(l,function(c){if(c.preventDefault(),e.allowClick){var d=parseInt(a(this).attr("data-rel"));k.go(b,d),c.stopPropagation()}return!1}).on("click",function(){return!1}),d.keyboard&&k.bindKeyboard(b),a(window).on("resize",function(){f=new Date,h===!1&&(h=!0,setTimeout(c,i))})},bindSwipe:function(b){function c(b){if(!u.dragging){var c=b.pageX||b.originalEvent.touches[0].pageX,e=b.pageY||b.originalEvent.touches[0].pageY;s=a(this),t=s.outerWidth(),w={x:c,y:e},x={x:0,y:0},u.dragging=!0,u.root.addClass(d.mod.dragging),a(this).hasClass(d.thumbsLayer)&&u.thumbsDragging&&(thumbsStartIndent=u.thumbsIndent,q=new Date,u.thumbsLayer.css("transition-duration","0s"))}}function e(a){var b=a.originalEvent&&a.originalEvent.touches,c=a.pageX||b&&b[0].pageX,e=a.pageY||b&&b[0].pageY;y=y||(b&&b.length)>1,console.log(b,y),"MSPointerMove"!=a.type&&"pointermove"!=a.type&&"undefined"==typeof p&&(p=!!(p||Math.abs(c-w.x)<Math.abs(e-w.y))),!u.dragging||y||p||(a.preventDefault(),w.x||w.y?x={x:c-w.x,y:e-w.y}:(w={x:c,y:e},x={x:0,y:0}),s.hasClass(d.thumbsLayer)?u.thumbsDragging&&m(s):j(s))}function f(a){if(console.log("end"),u.dragging){if(u.dragging=!1,u.root.removeClass(d.mod.dragging),0==x.x)return u.allowClick=!0,!0;u.allowClick=!1,setTimeout(function(){u.allowClick=!0},20),s.hasClass(d.thumbsLayer)?n(s):l(s),p=void 0,w={}}"MSPointerUp"!=a.type&&"MSPointerOut"!=a.type&&"pointerup"!=a.type&&"pointerleave"!=a.type&&(y=1==(a.originalEvent.touches&&a.originalEvent.touches.length))}function j(){u.allowClick=!1;var a,b;a=x.x/t*100,b=100*-u.current+a,u.layer.css(k.setIndent(b))}function l(a){var c,d=a.outerWidth();c=x.x>0?u.current+1:u.current-1,Math.abs(x.x)>.05*d?x.x<0?k.next(b):k.prev(b):k.go(b,u.current)}function m(){{var a;u.thumbs.outerWidth()}a=x.x+thumbsStartIndent,u.thumbsIndent=a,u.thumbsLayer.css(k.setIndent(a,"px"))}function n(){var a;u.thumbsDragging&&(r=new Date,a=x.x<0?-1:1,u.thumbsIndent=o(u.thumbsIndent,a),u.thumbsLayer.css("transition-duration",".24s").css(k.setIndent(u.thumbsIndent,"px")))}function o(a,b){var c,d,e=Math.abs(10*x.x/(r-q));return c=b*parseInt(Math.pow(e,2))+a,d=u.thumbs.outerWidth()-u.thumbsLayer.outerWidth(),c>0?0:d>c?d:c}var p,q,r,s,t,u=g[b],v=u.root.find("."+d.control+", ."+d.thumbsLayer),w={},x={},y=!1;if(u.dragging=!1,u.thumbsIndent=0,h)for(var z=0;z<v.length;z++)v[z].addEventListener(i[0],c),v[z].addEventListener(i[1],e),v[z].addEventListener(i[2],f),v[z].addEventListener(i[3],f);else v.on(i[0],c).on(i[1],e).on(i[2],f).on(i[3],f);u.thumbImg.on("dragstart",function(){return!1})},bindKeyboard:function(b){g[b];a(window).on("keydown",function(a){var c=a.which||a.keyCode;switch(c){case 32:k.next(b);break;case 37:k.prev(b);break;case 39:k.next(b)}})},go:function(a,b,c){var f=g[a];void 0===c&&(c=d.delay),f.layer.css("transition-duration",c+"ms").css(k.setIndent(100*-b)),f.current=b,k.setCurrentThumb(a,b),f.slide.removeClass(d.mod.current),f.slide.filter("."+d.slideIdPrefix+b).addClass(d.mod.current),k.loadSlides(a,b),k.checkButtons(a),clearTimeout(e),e=setTimeout(function(){f.layer.css("transition-duration","0s")},c)},next:function(a){var b=g[a];b.current<b.count?k.go(a,b.current+1):k.go(a,b.current)},prev:function(a){var b=g[a];b.current>0?k.go(a,b.current-1):k.go(a,b.current)},loadSlides:function(a,b){for(var c=g[a],e=(d.loadingRange,0>b-1?0:b-1),f=b+1>c.count?c.count:b+1,h=e;f>=h;h++)c.gallery[h].loaded||k.loadSlide(a,h)},loadSlide:function(b,c){var e=g[b],f=e.root.find("."+d.slide+"."+d.slideIdPrefix+c+" "),h=f.find("."+d.slideImg),i=e.gallery[c].url,j=document.createElement("img");!function(c){var g=a(j);g.on("load",function(){e.gallery[c].loaded=!0,e.gallery[c].width=this.width,e.gallery[c].height=this.height,f.removeClass(d.mod.loading),k.position(b,c)}).on("error",function(){a.error("Image wasn't loaded: "+this.src)}),j.src=i,h.css("background-image","url("+j.src+")")}(c)},loadThumbs:function(b){var c=g[b],d=c.count,e=c.thumbSrc,f=document.createElement("img"),h=0;c.galleryThumbs=[],c.galleryThumbsLoaded=!1;for(var i=0;d>=i;i++)!function(g){var i=a(f);i.on("load",function(){h++,h==d&&(c.galleryThumbsLoaded=!0,k.getThumbsSize(b))}).on("error",function(){a.error("Image wasn't loaded: "+this.src)}),f.src=e[g]}(i)},getThumbsSize:function(b){var c=g[b],d=c.thumb;d.each(function(b){var d=a(this);c.galleryThumbs[b]={},c.galleryThumbs[b].width=d.outerWidth(),c.galleryThumbs[b].height=d.outerHeight(),c.galleryThumbs[b].top=d.position().top+parseInt(d.css("margin-top")),c.galleryThumbs[b].left=d.position().left+parseInt(d.css("margin-left"))}),k.setCurrentThumb(b,c.current,1)},setCurrentThumb:function(a,b,c){function e(a){var b=o-p;return a>0||!j.thumbsDragging?0:b>a?b:a}var h,i,j=g[a],l=j.thumbFrame,m={},n=j.galleryThumbs[b],o=j.thumbs.outerWidth(),p=j.thumbsLayer.outerWidth(),q=c?"0s":".24s";j.thumbsDragging=p>o,j.galleryThumbsLoaded&&(m.width=n.width+"px",m.height=n.height+"px",d.transform?m[f[d.transform]]="translate3d("+n.left+"px, "+n.top+"px, 0)":(m.top=n.top+"px",m.left=n.left+"px"),h=-1*(n.left-.5*(o-n.width)),i=e(h),j.thumbsIndent=i,l.css("transition-duration",q).css(m),j.thumbsLayer.css("transition-duration",q).css(k.setIndent(i,"px")))},position:function(a,b){var c=g[a],e=c.root.find("."+d.slide+"."+d.slideIdPrefix+b),f=c.gallery[b],h=c.viewportWidth/c.viewportHeight,i=f.width/f.height;c.viewportWidth>f.width&&c.viewportHeight>f.height?e.removeClass(d.mod.auto).addClass(d.mod.center):e.removeClass(d.mod.center).addClass(d.mod.auto),i>=h?e.removeClass(d.mod.portrait).addClass(d.mod.landscape):e.removeClass(d.mod.landscape).addClass(d.mod.portrait)},checkButtons:function(a){var b=g[a];0==b.current?b.prev.addClass(d.mod.disabled):b.prev.removeClass(d.mod.disabled),b.current==b.count?b.next.addClass(d.mod.disabled):b.next.removeClass(d.mod.disabled)},setIndent:function(a,b){var c={};return b=b||"%",d.transform?c[f[d.transform]]="translate3d("+a+b+", 0, 0)":c.left=a+"%",c},getTemplate:function(a){return'<div class="'+d.slide+" "+d.slideIdPrefix+a+" "+d.mod.loading+'" data-id="'+a+'"><div class="'+d.slideImg+'"></div></div>'}};a.fn.photor=function(b){return k[b]?k[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Unknown method: "+b):k.init.apply(this,arguments)}}}(jQuery);