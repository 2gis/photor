!function(a){function b(){for(var a in f)if(void 0!==document.createElement("div").style[a])return a;return!1}function c(){var a=navigator.pointerEnabled,b=!!("ontouchstart"in window),c=["pointerdown","pointermove","pointerup","pointerleave"],d=["MSPointerDown","MSPointerMove","MSPointerUp","MSPointerOut"],e=["touchstart","touchmove","touchend","touchcancel"],f=["mousedown","mousemove","mouseup","mouseleave"];return a?c:h?d:b?e:f}if(window){var d,e,f={transform:"transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",WebkitTransform:"-webkit-transform"},g=[],h=navigator.msPointerEnabled,i=c(),j=!1;!function(){function a(a){if(b){b=!1;var c=document.createEvent("CustomEvent");c.initCustomEvent("fastclick",!0,!0,a.target),a.target.dispatchEvent(c),a.preventDefault()}}var b=!1;Element.prototype.addEventListener&&(j=!0,document.addEventListener(i[0],function(){b=!0},!1),document.addEventListener(i[1],function(){b=!1},!0),document.addEventListener(i[2],a,!1))}();var k={init:function(c){return d=a.extend({current:0,count:0,loadingRange:2,slideIdPrefix:"_",transform:b()},c),this.each(function(b){var c=a(this),e=this.id||b,f={},h="",i=0,j=[];f.root=c,f.control=c.find("."+d.control),f.next=c.find("."+d.next),f.prev=c.find("."+d.prev),f.thumbs=c.find("."+d.thumbs),f.thumbsLayer=c.find("."+d.thumbsLayer),f.thumb=c.find("."+d.thumb),f.thumbImg=c.find("."+d.thumbImg),f.thumbFrame=c.find("."+d.thumbFrame),f.viewport=c.find("."+d.viewport),f.layer=c.find("."+d.layer),f.gallery=[],f.thumb.each(function(b){var c=a(this),e=c.find("."+d.thumbImg)[0];f.gallery.push({url:this.href,width:0,height:0,loaded:!1}),h+=k.getTemplate(b),i++,c.attr("data-rel",b).addClass(d.slideIdPrefix+b),j[b]=e.src}),f.layer.html(h),f.slide=c.find("."+d.slide),f.current=d.current,f.count=i-1,f.dragging=!1,f.thumbsDragging=!1,f.allowClick=!0,f.viewportWidth=f.viewport.outerWidth(),f.viewportHeight=f.viewport.outerHeight(),f.thumbSrc=j,g[e]=f,k.loadThumbs(e),k.handlers(e),k.go(e,f.current,0)})},destroy:function(){a("."+d.next).off(),a("."+d.prev).off(),a("."+d.thumb).off()},handlers:function(b){function c(){new Date-f<i?setTimeout(c,i):(h=!1,e.viewportWidth=e.viewport.outerWidth(),e.viewportHeight=e.viewport.outerHeight(),e.slide.each(function(a){k.position(b,a)}),k.setCurrentThumb(b,e.current,1))}var e=g[b],f=new Date(1,1,2e3,12,0,0),h=!1,i=84,l=j?"fastclick":"click";e.next.on(l,function(a){e.allowClick&&!e.dragging&&(k.next(b),a.stopPropagation())}),e.prev.on(l,function(a){e.allowClick&&!e.dragging&&(k.prev(b),a.stopPropagation())}),e.thumb.on(l,function(c){if(c.preventDefault(),e.allowClick){var d=parseInt(a(this).attr("data-rel"));k.go(b,d),c.stopPropagation()}return!1}).on("click",function(){return!1}),d.swipe&&k.bindSwipe(b),d.keyboard&&k.bindKeyboard(b),a(window).on("resize",function(){f=new Date,h===!1&&(h=!0,setTimeout(c,i))})},bindSwipe:function(b){function c(b){if(!t.dragging){var c=a(this),e=b.pageX||b.originalEvent.touches[0].pageX,f=b.pageY||b.originalEvent.touches[0].pageY;s=c.outerWidth(),v={x:e,y:f},w={x:0,y:0},t.dragging=!0,t.root.addClass(d.mod.dragging),a(this).hasClass(d.thumbsLayer)&&t.thumbsDragging&&(thumbsStartIndent=t.thumbsIndent,q=new Date,t.thumbsLayer.css("transition-duration","0s"))}}function e(b){var c=b.originalEvent&&b.originalEvent.touches,e=b.pageX||c&&c[0].pageX,f=b.pageY||c&&c[0].pageY,g=a(this);return x=x||(c&&c.length)>1,"MSPointerMove"!=b.type&&"pointermove"!=b.type&&"undefined"==typeof p&&(p=!!(p||Math.abs(e-v.x)<Math.abs(f-v.y))),!t.dragging||x||p?void(t.dragging=!1):(b.preventDefault(),v.x||v.y?w={x:e-v.x,y:f-v.y}:(v={x:e,y:f},w={x:0,y:0}),void(g.hasClass(d.thumbsLayer)?t.thumbsDragging&&m(g):j(g)))}function f(b){if(t.dragging){var c=a(this);if(t.dragging=!1,t.root.removeClass(d.mod.dragging),0==w.x)return t.allowClick=!0,!0;t.allowClick=!1,setTimeout(function(){t.allowClick=!0},20),c.hasClass(d.thumbsLayer)?n(c):l(c)}p=void 0,"MSPointerUp"!=b.type&&"MSPointerOut"!=b.type&&"pointerup"!=b.type&&"pointerleave"!=b.type&&(x=1==(b.originalEvent.touches&&b.originalEvent.touches.length)),t.dragging=!1,v={}}function j(){t.allowClick=!1;var a,b;a=w.x/s*100,b=100*-t.current+a,t.layer.css(k.setIndent(b))}function l(a){var c,d=a.outerWidth();c=w.x>0?t.current+1:t.current-1,Math.abs(w.x)>.05*d?w.x<0?k.next(b):k.prev(b):k.go(b,t.current)}function m(){{var a;t.thumbs.outerWidth()}a=w.x+thumbsStartIndent,t.thumbsIndent=a,t.thumbsLayer.css(k.setIndent(a,"px"))}function n(){var a;t.thumbsDragging&&(r=new Date,a=w.x<0?-1:1,t.thumbsIndent=o(t.thumbsIndent,a),t.thumbsLayer.css("transition-duration",".24s").css(k.setIndent(t.thumbsIndent,"px")))}function o(a,b){var c,d,e=Math.abs(10*w.x/(r-q));return c=b*parseInt(Math.pow(e,2))+a,d=t.thumbs.outerWidth()-t.thumbsLayer.outerWidth(),c>0?0:d>c?d:c}var p,q,r,s,t=g[b],u=t.root.find("."+d.control+", ."+d.thumbsLayer),v={},w={},x=!1;t.dragging=!1,t.thumbsIndent=0,h?(u[0].addEventListener(i[0],c),u[0].addEventListener(i[1],e),u[0].addEventListener(i[2],f),u[0].addEventListener(i[3],f)):u.on(i[0],c).on(i[1],e).on(i[2],f).on(i[3],f),t.thumbImg.on("dragstart",function(){return!1})},bindKeyboard:function(b){g[b];a(window).on("keydown",function(a){var c=a.which||a.keyCode;switch(c){case 32:k.next(b);break;case 37:k.prev(b);break;case 39:k.next(b)}})},go:function(a,b,c){var f=g[a];void 0===c&&(c=d.delay),f.layer.css("transition-duration",c+"ms").css(k.setIndent(100*-b)),f.current=b,k.setCurrentThumb(a,b),f.slide.removeClass(d.mod.current),f.slide.filter("."+d.slideIdPrefix+b).addClass(d.mod.current),k.loadSlides(a,b),k.checkButtons(a),clearTimeout(e),e=setTimeout(function(){f.layer.css("transition-duration","0s")},c)},next:function(a){var b=g[a];b.current<b.count?k.go(a,b.current+1):k.go(a,b.current)},prev:function(a){var b=g[a];b.current>0?k.go(a,b.current-1):k.go(a,b.current)},loadSlides:function(a,b){for(var c=g[a],e=(d.loadingRange,0>b-1?0:b-1),f=b+1>c.count?c.count:b+1,h=e;f>=h;h++)c.gallery[h].loaded||k.loadSlide(a,h)},loadSlide:function(b,c){var e=g[b],f=e.root.find("."+d.slide+"."+d.slideIdPrefix+c+" "),h=f.find("."+d.slideImg),i=e.gallery[c].url,j=document.createElement("img");!function(c){var g=a(j);g.on("load",function(){e.gallery[c].loaded=!0,e.gallery[c].width=this.width,e.gallery[c].height=this.height,f.removeClass(d.mod.loading),k.position(b,c)}).on("error",function(){a.error("Image wasn't loaded: "+this.src)}),j.src=i,h.css("background-image","url("+j.src+")")}(c)},loadThumbs:function(b){var c=g[b],d=c.count,e=c.thumbSrc,f=document.createElement("img"),h=0;c.galleryThumbs=[],c.galleryThumbsLoaded=!1;for(var i=0;d>=i;i++)!function(g){var i=a(f);i.on("load",function(){h++,h==d&&(c.galleryThumbsLoaded=!0,k.getThumbsSize(b))}).on("error",function(){a.error("Image wasn't loaded: "+this.src)}),f.src=e[g]}(i)},getThumbsSize:function(b){var c=g[b],d=c.thumb;d.each(function(b){var d=a(this);c.galleryThumbs[b]={},c.galleryThumbs[b].width=d.outerWidth(),c.galleryThumbs[b].height=d.outerHeight(),c.galleryThumbs[b].top=d.position().top+parseInt(d.css("margin-top")),c.galleryThumbs[b].left=d.position().left+parseInt(d.css("margin-left"))}),k.setCurrentThumb(b,c.current,1)},setCurrentThumb:function(a,b,c){function e(a){var b=o-p;return a>0||!j.thumbsDragging?0:b>a?b:a}var h,i,j=g[a],l=j.thumbFrame,m={},n=j.galleryThumbs[b],o=j.thumbs.outerWidth(),p=j.thumbsLayer.outerWidth(),q=c?"0s":".24s";j.thumbsDragging=p>o,j.galleryThumbsLoaded&&(m.width=n.width+"px",m.height=n.height+"px",d.transform?m[f[d.transform]]="translate3d("+n.left+"px, "+n.top+"px, 0)":(m.top=n.top+"px",m.left=n.left+"px"),h=-1*(n.left-.5*(o-n.width)),i=e(h),j.thumbsIndent=i,l.css("transition-duration",q).css(m),j.thumbsLayer.css("transition-duration",q).css(k.setIndent(i,"px")))},position:function(a,b){var c=g[a],e=c.root.find("."+d.slide+"."+d.slideIdPrefix+b),f=c.gallery[b],h=c.viewportWidth/c.viewportHeight,i=f.width/f.height;c.viewportWidth>f.width&&c.viewportHeight>f.height?e.removeClass(d.mod.auto).addClass(d.mod.center):e.removeClass(d.mod.center).addClass(d.mod.auto),i>=h?e.removeClass(d.mod.portrait).addClass(d.mod.landscape):e.removeClass(d.mod.landscape).addClass(d.mod.portrait)},checkButtons:function(a){var b=g[a];0==b.current?b.prev.addClass(d.mod.disabled):b.prev.removeClass(d.mod.disabled),b.current==b.count?b.next.addClass(d.mod.disabled):b.next.removeClass(d.mod.disabled)},setIndent:function(a,b){var c={};return b=b||"%",d.transform?c[f[d.transform]]="translate3d("+a+b+", 0, 0)":c.left=a+"%",c},getTemplate:function(a){return'<div class="'+d.slide+" "+d.slideIdPrefix+a+" "+d.mod.loading+'" data-id="'+a+'"><div class="'+d.slideImg+'"></div></div>'}};a.fn.photor=function(b){return k[b]?k[b].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof b&&b?void a.error("Unknown method: "+b):k.init.apply(this,arguments)}}}(jQuery);