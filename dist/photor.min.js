!function(){function a(){var a=navigator.userAgent.toLowerCase();return-1!=a.indexOf("msie")?parseInt(a.split("msie")[1]):!1}function b(){var a=!1,b=document.createElement("p");for(var c in o)if(void 0!==b.style[c]){a={property:c};break}return document.body.insertBefore(b,null),a.property&&(b.style[a.property]="translate3d(1px,1px,1px)",a.has3d="none"!=window.getComputedStyle(b).getPropertyValue(o[a.property])),document.body.removeChild(b),a}function c(a){var b=document.createElement("p").style,c=["ms","O","Moz","Webkit"];if(""==b[a])return a;a=a.charAt(0).toUpperCase()+a.slice(1);for(var d=0;d<c.length;d++)if(""==b[c[d]+a])return c[d]+a}function d(a,b,c,d,e){d=!!d,a&&(e?a.removeEventListener?a.removeEventListener(b,c,d):$(a).off(b):a.addEventListener?a.addEventListener(b,c,d):$(a).on(b,c))}function e(a,b){if(a){var c=" "+a.className+" ";return b=" "+b+" ",c.replace(/[\n\t]/g," ").indexOf(b)>-1?!0:!1}}function f(){var a="ontouchstart"in window;return a?["touchstart","touchmove","touchend","touchcancel"]:["mousedown","mousemove","mouseup","mouseleave"]}function g(a,b,c,d){3==arguments.length&&"boolean"!=typeof c&&(d=c,c=!1);var e;return function(){var f=arguments;d=d||this,c&&!e&&a.apply(d,f),clearTimeout(e),e=setTimeout(function(){c||a.apply(d,f),e=null},b)}}function h(a){function b(a){var b,c=p[a];if(c.params.transform){var d=c.layer.css(o[c.params.transform.property]).match(/(-?[0-9\.]+)/g);b=d.length>6?d[13]:d[4]}else b=c.layer.css("left");return parseInt(b)}function c(){l.isSlide&&(l.isThumbs?h():j.params.transition&&f()),l={},j.root.removeClass(j.params._dragging)}function d(){var b;(0==j.current&&l.shiftX>0||j.current==j.count&&l.shiftX<0)&&(l.shiftX=l.shiftX/3),b=(l.shiftX+l.startShift)/j.viewportWidth*100,j.layer.css(s.setIndent(a,Math.round(100*b)/100))}function f(){Math.abs(l.shiftX)>.05*j.controlWidth?l.shiftX<0?s.next(a):s.prev(a):s.go(a,j.current)}function g(){var b=l.shiftX+l.thumbsStartX,c=-1*(j.thumbsLayerWidth-j.thumbsWidth);b>0&&(b/=3),c>b&&(b=c+(b-c)/3),j.thumbsIndent=b,j.thumbsLayer.css(s.setIndent(a,j.thumbsIndent,"px"))}function h(){if(j.thumbsDragging&&l.isSlide){var b=l.shiftX<0?-1:1;l.t2=new Date,j.thumbsIndent=i(j.thumbsIndent,b),j.thumbsLayer.css("transition-duration",".24s").css(s.setIndent(a,j.thumbsIndent,"px"))}}function i(a,b){var c,d,e=Math.abs(10*l.shiftX/(l.t2-l.t1));return c=b*parseInt(Math.pow(e,2))+a,d=j.thumbs.outerWidth()-j.thumbsLayer.outerWidth(),c>0?0:d>c?d:c}var j=p[a],k=(j.control,j.thumbs),l={};r.onStart=function(a){j.freeze||(l.x1=a.clientX||a.touches&&a.touches[0].clientX,l.y1=a.clientY||a.touches&&a.touches[0].clientY,l.t1=new Date,l.isPressed=!0,l.isThumbs=e(this,j.params.thumbs),l.thumbsStartX=j.thumbsIndent,j.layer.css("transition-duration","0s"),j.thumbsLayer.css("transition-duration","0s"))},r.onMove=function(e){if(l.isPressed&&!j.freeze){if(l.shiftX=(e.clientX||e.touches&&e.touches[0].clientX)-l.x1,l.shiftY=(e.clientY||e.touches&&e.touches[0].clientY)-l.y1,l.shiftXAbs=Math.abs(l.shiftX),l.shiftYAbs=Math.abs(l.shiftY),l.isMultitouch=l.isMultitouch||(e.touches&&e.touches.length)>1,l.isMultitouch)return void c();l.isSlide||l.isScroll||(l.shiftYAbs>=5&&l.shiftYAbs>l.shiftXAbs&&(l.isScroll=!0),l.shiftXAbs>=5&&l.shiftXAbs>l.shiftYAbs&&(j.root.addClass(j.params._dragging),l.isSlide=!0,l.startShift=b(a))),l.isSlide&&(l.isThumbs?j.thumbsDragging&&g():j.params.transition&&d(),e.preventDefault&&e.preventDefault())}},r.onEnd=function(b){l.isSlide||l.isScroll||!l.isPressed||(e(b.target,j.params.prev)&&s.prev(a),e(b.target,j.params.next)&&s.next(a),(e(b.target,j.params.thumbImg)||e(b.target,j.params.thumb))&&s.go(a,parseInt(b.target.getAttribute("data-rel"))),b.stopPropagation&&b.preventDefault&&(b.stopPropagation(),b.preventDefault())),c()},j.events.push({element:j.viewport[0],event:q[0],handler:r.onStart},{element:j.viewport[0],event:q[1],handler:r.onMove,capture:!0},{element:j.viewport[0],event:q[2],handler:r.onEnd},{element:j.viewport[0],event:q[3],handler:r.onEnd},{element:k[0],event:q[0],handler:r.onStart},{element:k[0],event:q[1],handler:r.onMove,capture:!0},{element:k[0],event:q[2],handler:r.onEnd},{element:k[0],event:q[3],handler:r.onEnd});for(var m=0;m<j.thumb.length;m++)j.events.push({element:j.thumb[m],event:"click",handler:function(a){return a.preventDefault&&a.preventDefault(),!1}});for(var n=0;n<j.thumbImg.length;n++)j.events.push({element:j.thumbImg[n],event:"dragstart",handler:function(a){return a.preventDefault&&a.preventDefault(),!1}})}function i(a){if(!r.resize){var b=p[a];r.resize=g(s.update,84),b.events.push({element:window,event:"resize",handler:r.resize})}}function j(a){var b=p[a];r.keydown=function(b){var c=b.which||b.keyCode,d=b.target.nodeName.toLowerCase(),e=!!b.target.attributes.contenteditable;if("input"!=d&&"textarea"!=d&&"select"!=d&&!e)switch(c){case 32:s.next(a);break;case 37:s.prev(a);break;case 39:s.next(a)}},b.events.push({element:window,event:"keydown",handler:r.keydown})}function k(a){var b=p[a],c=["webkitTransitionEnd","MSTransitionEnd","oTransitionEnd","transitionend"];r.transitionEnd=function(b){var c=b.propertyName;(c.lastIndexOf("transform")==c.length-"transform".length||"left"==c)&&l(a)};for(var d=0;d<c.length;d++)b.events.push({element:b.layer[0],event:c[d],handler:r.transitionEnd})}function l(a){var b=p[a];b.root.removeClass(b.params._animated),b.layer.css("transition-duration","0s"),m(a,b.current),b.params.onShow&&b.params.onShow(b)}function m(a,b){for(var c=p[a],d=0;d<c.count;d++){var e=c.root.find("."+c.params.slide+"."+c.params.modifierPrefix+d);d>=c.current-1&&d<=c.current+1||d>=b-1&&b+1>=d?e.removeClass(c.params._hidden):e.addClass(c.params._hidden)}}if(window){var n,o={transform:"transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",WebkitTransform:"-webkit-transform"},p=[],q=f(),r=[],s={init:function(d){var e="photor__";return n=$.extend({control:e+"viewportControl",next:e+"viewportControlNext",prev:e+"viewportControlPrev",thumbs:e+"thumbs",thumbsLayer:e+"thumbsWrap",thumb:e+"thumbsWrapItem",thumbImg:e+"thumbsWrapItemImg",thumbFrame:e+"thumbsWrapFrame",viewport:e+"viewport",layer:e+"viewportLayer",slide:e+"viewportLayerSlide",slideImg:e+"viewportLayerSlideImg",_loading:"_loading",_current:"_current",_dragging:"_dragging",_disabled:"_disabled",_alt:"_alt",_single:"_single",_animated:"_animated",_hidden:"_hidden",_html:"_html",_freeze:"_freeze",_auto:"_auto",_center:"_center",_portrait:"_portrait",_landscape:"_landscape",_draggable:"_draggable",single:!1,current:0,count:0,modifierPrefix:"_",delay:300,keyboard:!0,ieClassPrefix:"_ie",showThumbs:"thumbs",loop:!1,transform:b(),transition:c("transition"),ie:a()},d),this.each(function(){var a,b=$(this),c=this.id||p.length,d={},e={},f={url:"",thumb:"",caption:"",width:0,height:0,loaded:!1,classes:""},g=!1;if(!b.attr("data-photor-id")){if(d.params=$.extend({},n),d.root=b,d.control=b.find("."+d.params.control),d.next=b.find("."+d.params.next),d.prev=b.find("."+d.params.prev),d.thumbs=b.find("."+d.params.thumbs),d.thumbsLayer=b.find("."+d.params.thumbsLayer),d.viewport=b.find("."+d.params.viewport),d.layer=b.find("."+d.params.layer),d.gallery=[],d.params.data&&d.params.data.length)for(a=0;a<d.params.data.length;a++)d.gallery.push($.extend({},f,d.params.data[a]));else{var h=b.find("."+d.params.layer+" > *");h.length&&h.each(function(){var a="IMG"==this.nodeName;g=g||!a,d.gallery.push(a?$.extend({},f,{url:this.src,caption:this.alt,thumb:$(this).data("thumb"),classes:this.className}):$.extend({},f,{html:this.outerHTML,loaded:!0}))})}g&&"thumbs"==d.params.showThumbs&&(d.params.showThumbs="dots"),e=s.getHTML(d.params,d.gallery),d.layer.html(e.slides),d.thumbsLayer.html(e.thumbs),d.thumb=b.find("."+d.params.thumb),d.thumbImg=b.find("."+d.params.thumbImg),d.thumbFrame=b.find("."+d.params.thumbFrame),d.slide=b.find("."+d.params.slide),d.slideImg=b.find("."+d.params.slideImg),d.slide.each(function(a){$(this).css("left",100*a+"%")}),d.current=d.params.current,d.count=d.gallery.length-1,d.thumbsDragging=!1,d.thumbsIndent=0,d.events=[],d.viewportWidth=d.viewport.outerWidth(),d.viewportHeight=d.viewport.outerHeight(),d.controlWidth=d.control.outerWidth(),d.controlHeight=d.control.outerHeight(),d.thumbsWidth=d.thumbs.outerWidth(),d.thumbsHeight=d.thumbs.outerHeight(),p[c]=d,b.attr("data-photor-id",c),d.params.showThumbs&&b.addClass(d.params.modifierPrefix+d.params.showThumbs),d.params.ie&&b.addClass(d.params.ieClassPrefix+d.params.ie),1==d.gallery.length&&b.addClass(d.params._single),"thumbs"==d.params.showThumbs&&s.loadThumbs(c),(d.gallery.length>1||d.params.single)&&s.handlers(c),s.go(c,d.current,0),l(c)}})},update:function(){function a(a){var b=p[a];b.viewportWidth=b.viewport.outerWidth(),b.viewportHeight=b.viewport.outerHeight(),b.controlWidth=b.control.outerWidth(),b.controlHeight=b.control.outerHeight(),b.thumbsWidth=b.thumbs.outerWidth(),b.thumbsHeight=b.thumbs.outerHeight(),b.thumbsLayerWidth=b.thumbsLayer.outerWidth(),b.slide.each(function(b){s.position(a,b)}),"thumbs"==b.params.showThumbs&&s.getThumbsSize(a),s.go(a,b.current,0)}for(var b in p)a(b)},destroy:function(a){function b(a){for(var b=p[a],c=0,e=b.events.length;e>c;c++)d(b.events[c].element,b.events[c].event,b.events[c].handler,b.events[c].capture,1)}if("undefined"!=typeof a)b(a);else for(var c in p)b(c)},handlers:function(a){var b=p[a];h(a),i(a),k(a),b.params.keyboard&&j(a);for(var c=0,e=b.events.length;e>c;c++)d(b.events[c].element,b.events[c].event,b.events[c].handler,b.events[c].capture)},go:function(a,b,c){var d=p[a];d.freeze||(m(a,b),c=null==c?d.params.delay:c,d.root.addClass(d.params._animated),d.layer.css("transition-duration",c+"ms").css(s.setIndent(a,100*-b)),d.current=b,s.loadSlides(a,b),s.checkButtons(a),s.setCurrentThumb(a,b),d.slide.removeClass(d.params._current),d.slide.filter("."+d.params.modifierPrefix+b).addClass(d.params._current),d.params.transition||l(a))},next:function(a){var b=p[a];b.current<b.count?s.go(a,b.current+1):s.go(a,b.params.loop?0:b.current)},prev:function(a){var b=p[a];b.current>0?s.go(a,b.current-1):s.go(a,b.params.loop?b.count:0)},loadSlides:function(a,b){for(var c=p[a],d=0>b-1?0:b-1,e=b+1>c.count?c.count:b+1,f=d;e>=f;f++)c.gallery[f].loaded||s.loadSlide(a,f)},loadSlide:function(a,b){var c=p[a],d=c.root.find("."+c.params.slide+"."+c.params.modifierPrefix+b),e=d.find("."+c.params.slideImg),f=c.gallery[b].caption,g=c.gallery[b].url,h=document.createElement("img");!function(b,e){var i=$(h);i.on("load",function(){c.gallery[b].loaded=!0,c.gallery[b].width=this.width,c.gallery[b].height=this.height,s.position(a,b),c.params.ie&&c.params.ie<9?e.attr("src",this.src):e.css("background-image","url("+this.src+")"),d.removeClass(c.params._loading)}).on("error",function(){$.error("Image wasn't loaded: "+this.src)}),h.src=g,f&&e.addClass(c.params._alt).attr("data-alt",f)}(b,e)},loadThumbs:function(a){var b=p[a],c=b.count+1,d=b.gallery,e=0;b.galleryThumbs=[],b.galleryThumbsLoaded=!1;for(var f=0;c>f;f++)!function(f){var g=document.createElement("img"),h=$(g);h.on("load",function(){e++,e==c&&(b.galleryThumbsLoaded=!0,s.getThumbsSize(a))}).on("error",function(){$.error("Image wasn't loaded: "+this.src)}),g.src=d[f].thumb}(f)},getThumbsSize:function(a){var b=p[a],c=b.thumb;c.each(function(a){var c=$(this);b.galleryThumbs[a]={},b.galleryThumbs[a].width=c.outerWidth(),b.galleryThumbs[a].height=c.outerHeight(),b.galleryThumbs[a].top=c.position().top+parseInt(c.css("margin-top")),b.galleryThumbs[a].left=c.position().left+parseInt(c.css("margin-left"))}),b.thumbsLayerWidth=b.thumbsLayer.outerWidth(),s.setCurrentThumb(a,b.current,1)},setCurrentThumb:function(a,b,c){function d(a){var b=k-l;return a>0||!e.thumbsDragging?0:b>a?b:a}var e=p[a];if("thumbs"==e.params.showThumbs){var f,g,h=e.thumbFrame,i={},j=e.galleryThumbs&&e.galleryThumbs[b],k=e.thumbs.outerWidth(),l=e.thumbsLayer.outerWidth(),m=c?"0s":.8*e.params.delay/1e3+"s";if(e.thumbsDragging=l>k,e.galleryThumbsLoaded){if(i.width=j.width+"px",i.height=j.height+"px",e.params.transform){var n=o[e.params.transform.property];i[n]=e.params.transform.has3d?"translate3d("+j.left+"px, "+j.top+"px, 0)":"translateX("+j.left+"px) translateY("+j.top+"px)"}else i.top=j.top+"px",i.left=j.left+"px";f=-1*(j.left-.5*(k-j.width)),g=d(f),e.thumbsIndent=g,h.css("transition-duration",m).css(i),e.thumbsLayer.css("transition-duration",m).css(s.setIndent(a,g,"px"))}}e.thumb.removeClass(e.params._current),e.thumb.filter("."+e.params.modifierPrefix+b).addClass(e.params._current)},position:function(a,b){var c=p[a],d=c.root.find("."+c.params.slide+"."+c.params.modifierPrefix+b),e=c.gallery[b],f=c.viewportWidth/c.viewportHeight,g=e.width/e.height;c.viewportWidth>e.width&&c.viewportHeight>e.height?(c.gallery[b].algorithm="center",d.removeClass(c.params._auto).addClass(c.params._center)):(c.gallery[b].algorithm="auto",d.removeClass(c.params._center).addClass(c.params._auto)),g>=f?(c.gallery[b].orientation="landscape",d.removeClass(c.params._portrait).addClass(c.params._landscape)):(c.gallery[b].orientation="portrait",d.removeClass(c.params._landscape).addClass(c.params._portrait))},checkButtons:function(a){var b=p[a];0==b.current?b.prev.addClass(b.params._disabled):b.prev.removeClass(b.params._disabled),b.current==b.count?b.next.addClass(b.params._disabled):b.next.removeClass(b.params._disabled)},setIndent:function(a,b,c){var d=p[a],e={};if(c=c||"%",d.params.transform){var f=o[d.params.transform.property];e[f]=d.params.transform.has3d?"translate3d("+b+c+", 0, 0)":"translateX("+b+c+")"}else e.left=b+c;return e},freeze:function(a){var b=p[a];b.freeze=!0,b.root.addClass(b.params._freeze)},unfreeze:function(a){var b=p[a];b.freeze=!1,b.root.removeClass(b.params._freeze)},getHTML:function(a,b){for(var c="",d="",e=0;e<b.length;e++)c+='<span data-rel="'+e+'" class="'+a.thumb+" "+a.modifierPrefix+e+" "+b[e].classes+'">',"thumbs"==a.showThumbs&&b[e].url&&(c+='<img src="'+b[e].thumb+'" class="'+a.thumbImg+'" data-rel="'+e+'">'),c+="</span>",d+='<div class="'+a.slide+" "+a.modifierPrefix+e+" "+(b[e].html?a._html:a._loading)+'" data-id="'+e+'">',d+=b[e].html?b[e].html:a.ie&&a.ie<9?'<img src="" class="'+a.slideImg+" "+b[e].classes+'">':'<div class="'+a.slideImg+" "+b[e].classes+'"></div>',d+="</div>";return"thumbs"==a.showThumbs&&(c+='<div class="'+a.thumbFrame+'"></div>'),{thumbs:c,slides:d}}};$.fn.photor=function(a){return s[a]?s[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof a&&a?void $.error("Unknown method: "+a):s.init.apply(this,arguments)}}}(jQuery);