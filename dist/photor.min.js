!function(){function a(){for(var a in l)if(void 0!==document.createElement("div").style[a])return a;return!1}function b(a,b,c,d,e){e=!!e,b?a.addEventListener?a.addEventListener(c,d,e):a.attachEvent?a.attachEvent("on"+c,d):a[c]=d:a.removeEventListener?a.removeEventListener(c,d,e):a.detachEvent?a.detachEvent("on"+c,d):a[c]=void 0}function c(a,b){var c=" "+a.className+" ";return b=" "+b+" ",c.replace(/[\n\t]/g," ").indexOf(b)>-1?!0:!1}function d(){var a=!!("ontouchstart"in window);return a?["touchstart","touchmove","touchend","touchcancel"]:["mousedown","mousemove","mouseup","mouseleave"]}function f(a,b,c,d){3==arguments.length&&"boolean"!=typeof c&&(d=c,c=!1);var e;return function(){var f=arguments;d=d||this,c&&!e&&a.apply(d,f),clearTimeout(e),e=setTimeout(function(){c||a.apply(d,f),e=null},b)}}function g(a){function d(){s.isSlide&&(s.isThumbs?i():g()),s={}}function f(){(0==l.current&&s.shiftX>0||l.current==l.count&&s.shiftX<0)&&(s.shiftX=s.shiftX/3),l.layer.css(p.setIndent(100*(s.shiftX/l.controlWidth-l.current)))}function g(){Math.abs(s.shiftX)>.05*l.controlWidth?s.shiftX<0?p.next(a):p.prev(a):p.go(a,l.current)}function h(){l.thumbsIndent=s.shiftX+s.thumbsStartX,l.thumbsLayer.css(p.setIndent(l.thumbsIndent,"px"))}function i(){if(l.thumbsDragging&&s.isSlide){var a=s.shiftX<0?-1:1;s.t2=new Date,l.thumbsIndent=j(l.thumbsIndent,a),l.thumbsLayer.css("transition-duration",".24s").css(p.setIndent(l.thumbsIndent,"px"))}}function j(a,b){var c,d,e=Math.abs(10*s.shiftX/(s.t2-s.t1));return c=b*parseInt(Math.pow(e,2))+a,d=l.thumbs.outerWidth()-l.thumbsLayer.outerWidth(),c>0?0:d>c?d:c}var l=m[a],q=l.control,r=l.thumbs,s={};o.onStart=function(a){console.log("Touch start"),s.x1=a.clientX||a.touches&&a.touches[0].clientX,s.y1=a.clientY||a.touches&&a.touches[0].clientY,s.t1=new Date,s.isPressed=!0,s.isThumbs=c(this,k.thumbs),s.thumbsStartX=l.thumbsIndent,l.root.addClass(k.mod.dragging)},o.onMove=function(a){if(s.isPressed){if(console.log("Touch move"),s.shiftX=(a.clientX||a.touches&&a.touches[0].clientX)-s.x1,s.shiftY=(a.clientY||a.touches&&a.touches[0].clientY)-s.y1,s.shiftXAbs=Math.abs(s.shiftX),s.shiftYAbs=Math.abs(s.shiftY),s.isMultitouch=s.isMultitouch||(a.touches&&a.touches.length)>1,s.isMultitouch)return void d();s.isSlide||s.isScroll||(s.shiftYAbs>=5&&s.shiftYAbs>s.shiftXAbs&&(s.isScroll=!0),s.shiftXAbs>=5&&s.shiftXAbs>s.shiftYAbs&&(s.isSlide=!0)),s.isSlide&&(a.preventDefault(),s.isThumbs?l.thumbsDragging&&h():f())}},o.onEnd=function(b){console.log("Touch end"),s.isSlide||s.isScroll||!s.isPressed||(c(b.target,k.prev)&&p.prev(a),c(b.target,k.next)&&p.next(a),c(b.target,k.thumbImg)&&p.go(a,parseInt(b.target.getAttribute("data-rel"))),b.stopPropagation(),b.preventDefault()),d()},b(q[0],!0,n[0],o.onStart,!1),b(q[0],!0,n[1],o.onMove,!0),b(q[0],!0,n[2],o.onEnd,!1),b(q[0],!0,n[3],o.onEnd,!1),b(r[0],!0,n[0],o.onStart,!1),b(r[0],!0,n[1],o.onMove,!0),b(r[0],!0,n[2],o.onEnd,!1),b(r[0],!0,n[3],o.onEnd,!1),l.thumb.on("click",function(){e.preventDefault()}),l.thumbImg.on("dragstart",function(){e.preventDefault()})}function h(a){function c(){console.log("Resize"),d.viewportWidth=d.viewport.outerWidth(),d.viewportHeight=d.viewport.outerHeight(),d.controlWidth=d.control.outerWidth(),d.controlHeight=d.control.outerHeight(),d.thumbsWidth=d.thumbs.outerWidth(),d.thumbsHeight=d.thumbs.outerHeight(),d.slide.each(function(b){p.position(a,b)}),p.setCurrentThumb(a,d.current,1)}var d=m[a];o.resize=f(c,84),b(window,!0,"resize",o.resize)}function i(a){m[a];o.keydown=function(b){var c=b.which||b.keyCode;switch(console.log("Keydown "+c),c){case 32:p.next(a);break;case 37:p.prev(a);break;case 39:p.next(a)}},b(window,!0,"keydown",o.keydown,!1)}function j(a){var c=m[a];b(c.layer[0],"transitionend",handler.transitionEnd,!1),o.transitionEnd=function(){console.log("Transition end"),c.layer.css("transition-duration","0s");for(var a=0;a<c.count;a++){var b=c.root.find("."+k.slide+"."+k.slideIdPrefix+a);a<c.current-1||a>c.current+1?b.addClass("_hidden"):b.removeClass("_hidden")}}}if(window){var k,l={transform:"transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",WebkitTransform:"-webkit-transform"},m=[],n=d(),o=[],p={init:function(b){return k=$.extend({current:0,count:0,loadingRange:2,slideIdPrefix:"_",transform:a()},b),this.each(function(a){var b=$(this),c=this.id||a,d={},e="",f=0,g=[];d.root=b,d.control=b.find("."+k.control),d.next=b.find("."+k.next),d.prev=b.find("."+k.prev),d.thumbs=b.find("."+k.thumbs),d.thumbsLayer=b.find("."+k.thumbsLayer),d.thumb=b.find("."+k.thumb),d.thumbImg=b.find("."+k.thumbImg),d.thumbFrame=b.find("."+k.thumbFrame),d.viewport=b.find("."+k.viewport),d.layer=b.find("."+k.layer),d.gallery=[],d.thumb.each(function(a){var b=$(this),c=b.find("."+k.thumbImg)[0];d.gallery.push({url:this.href,width:0,height:0,loaded:!1,alt:c.alt}),e+=p.getTemplate(a),f++,$(c).attr("data-rel",a).addClass(k.slideIdPrefix+a),g[a]=c.src}),d.layer.html(e),d.slide=b.find("."+k.slide),d.slide.each(function(a){$(this).css("left",100*a+"%")}),d.current=k.current,d.count=f-1,d.thumbsDragging=!1,d.thumbsIndent=0,d.viewportWidth=d.viewport.outerWidth(),d.viewportHeight=d.viewport.outerHeight(),d.controlWidth=d.control.outerWidth(),d.controlHeight=d.control.outerHeight(),d.thumbsWidth=d.thumbs.outerWidth(),d.thumbsHeight=d.thumbs.outerHeight(),d.thumbSrc=g,m[c]=d,b.attr("data-photor-id",c),p.loadThumbs(c),p.handlers(c),p.go(c,d.current,0)})},destroy:function(a){if("undefined"!=typeof a){m[a]}console.log("destroy")},handlers:function(a){m[a];g(a),k.keyboard&&i(a),h(a),j(a)},go:function(a,b,c){var d=m[a];void 0===c&&(c=k.delay),d.layer.css("transition-duration",c+"ms").css(p.setIndent(100*-b)),d.current=b,p.setCurrentThumb(a,b),d.slide.removeClass(k.mod.current),d.slide.filter("."+k.slideIdPrefix+b).addClass(k.mod.current),p.loadSlides(a,b),p.checkButtons(a)},next:function(a){var b=m[a];b.current<b.count?p.go(a,b.current+1):p.go(a,b.current)},prev:function(a){var b=m[a];b.current>0?p.go(a,b.current-1):p.go(a,b.current)},loadSlides:function(a,b){for(var c=m[a],d=(k.loadingRange,0>b-1?0:b-1),e=b+1>c.count?c.count:b+1,f=d;e>=f;f++)c.gallery[f].loaded||p.loadSlide(a,f)},loadSlide:function(a,b){var c=m[a],d=c.root.find("."+k.slide+"."+k.slideIdPrefix+b),e=d.find("."+k.slideImg),f=c.gallery[b].alt,g=c.gallery[b].url,h=document.createElement("img");!function(b){var i=$(h);i.on("load",function(){c.gallery[b].loaded=!0,c.gallery[b].width=this.width,c.gallery[b].height=this.height,d.removeClass(k.mod.loading),p.position(a,b)}).on("error",function(){$.error("Image wasn't loaded: "+this.src)}),h.src=g,e.css("background-image","url("+h.src+")"),f&&e.addClass(k.mod.alt).attr("data-alt",f)}(b)},loadThumbs:function(a){var b=m[a],c=b.count,d=b.thumbSrc,e=document.createElement("img"),f=0;b.galleryThumbs=[],b.galleryThumbsLoaded=!1;for(var g=0;c>=g;g++)!function(g){var h=$(e);h.on("load",function(){f++,f==c&&(b.galleryThumbsLoaded=!0,p.getThumbsSize(a))}).on("error",function(){$.error("Image wasn't loaded: "+this.src)}),e.src=d[g]}(g)},getThumbsSize:function(a){var b=m[a],c=b.thumb;c.each(function(a){var c=$(this);b.galleryThumbs[a]={},b.galleryThumbs[a].width=c.outerWidth(),b.galleryThumbs[a].height=c.outerHeight(),b.galleryThumbs[a].top=c.position().top+parseInt(c.css("margin-top")),b.galleryThumbs[a].left=c.position().left+parseInt(c.css("margin-left"))}),p.setCurrentThumb(a,b.current,1)},setCurrentThumb:function(a,b,c){function d(a){var b=n-o;return a>0||!g.thumbsDragging?0:b>a?b:a}var e,f,g=m[a],h=g.thumbFrame,i={},j=g.galleryThumbs[b],n=g.thumbs.outerWidth(),o=g.thumbsLayer.outerWidth(),q=c?"0s":".24s";g.thumbsDragging=o>n,g.galleryThumbsLoaded&&(i.width=j.width+"px",i.height=j.height+"px",k.transform?i[l[k.transform]]="translate3d("+j.left+"px, "+j.top+"px, 0)":(i.top=j.top+"px",i.left=j.left+"px"),e=-1*(j.left-.5*(n-j.width)),f=d(e),g.thumbsIndent=f,h.css("transition-duration",q).css(i),g.thumbsLayer.css("transition-duration",q).css(p.setIndent(f,"px")))},position:function(a,b){var c=m[a],d=c.root.find("."+k.slide+"."+k.slideIdPrefix+b),e=c.gallery[b],f=c.viewportWidth/c.viewportHeight,g=e.width/e.height;c.viewportWidth>e.width&&c.viewportHeight>e.height?d.removeClass(k.mod.auto).addClass(k.mod.center):d.removeClass(k.mod.center).addClass(k.mod.auto),g>=f?d.removeClass(k.mod.portrait).addClass(k.mod.landscape):d.removeClass(k.mod.landscape).addClass(k.mod.portrait)},checkButtons:function(a){var b=m[a];0==b.current?b.prev.addClass(k.mod.disabled):b.prev.removeClass(k.mod.disabled),b.current==b.count?b.next.addClass(k.mod.disabled):b.next.removeClass(k.mod.disabled)},setIndent:function(a,b){var c={};return b=b||"%",k.transform?c[l[k.transform]]="translate3d("+a+b+", 0, 0)":c.left=a+"%",c},getTemplate:function(a){return'<div class="'+k.slide+" "+k.slideIdPrefix+a+" "+k.mod.loading+'" data-id="'+a+'"><div class="'+k.slideImg+'"></div></div>'}};$.fn.photor=function(a){return p[a]?p[a].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof a&&a?void $.error("Unknown method: "+a):p.init.apply(this,arguments)}}}(jQuery);